% kinematical simulations across 2000 nm and 100 ps in 1 ps timesteps.
%bf_contrast_kinematical_-1-79A_-2-4B = ;
kin_UEM = [0.370813667384958,0.370688349338649,0.370566182593749,0.370452975156760,0.370355009046182,0.370276280638615,0.370219350128512,0.370184728565653,0.370171059100035,0.370175983574204,0.370197084128216,0.370232383912804,0.370281175220447,0.370343940647928,0.370421031681451,0.370512055266241,0.370614878735371,0.370725537832971,0.370839902853648,0.370951005372867,0.371051816986431,0.371134512305019,0.371191681994580,0.371217723498331,0.371209613070285,0.371167411456245,0.371094617679837,0.370997481603698,0.370883349627260,0.370760173848538,0.370635254087464,0.370516170895684,0.370408789803612,0.370318640385839,0.370249071589908,0.370201801539517,0.370176416013153,0.370171040823717,0.370183174889828,0.370210561058581,0.370251635483800,0.370306304510109,0.370375219273071,0.370458468122266,0.370554971724963,0.370661570202162,0.370774483444080,0.370888234914071,0.370995958483444,0.371089966909394,0.371162510407103,0.371206899713267,0.371218502954747,0.371195580128597,0.371139664450514,0.371055544478783,0.370950255319122,0.370831286203813,0.370706334959287,0.370583207815054,0.370468290749136,0.370367888828644,0.370286213344916,0.370226092466282,0.370188334399142,0.370171812653070,0.370174236724686,0.370193161414290,0.370226521361563,0.370273370192816,0.370334103832381,0.370409148850452,0.370498299235923,0.370599640853891,0.370709402596130,0.370823527031366,0.370935596784538,0.371038348818954,0.371124108518197,0.371185316812537,0.371216055001188,0.371212897172976,0.371175425810783,0.371106718055307,0.371012568595284,0.370900365644396,0.370778145302199,0.370652862437561,0.370532564813416,0.370423137972016,0.370330444112920,0.370257646879636,0.370207235461602,0.370178755198428,0.370170680330176,0.370180459090164,0.370205788512416,0.370244936060225,0.370297640549887,0.370364498468173,0.370445746332261];
kin_5A_2B = [0.157578841429396,0.157744184477128,0.157910078734678,0.158071770780852,0.158207073381191,0.158331441823528,0.158419467663757,0.158469493214927,0.158483316876299,0.158460575302714,0.158402468716169,0.158313089452573,0.158193587373527,0.158058389102796,0.157912729061809,0.157752570832722,0.157599390947031,0.157454287386296,0.157314709269206,0.157204573589950,0.157112932358417,0.157048018717109,0.157015803734147,0.157016341973346,0.157050358395352,0.157117358655787,0.157215485240148,0.157342612674880,0.157488215459329,0.157654857254582,0.157813412776730,0.157980284880586,0.158132788994610,0.158267264765853,0.158373724928968,0.158445043206691,0.158479895026629,0.158478020379588,0.158439867880811,0.158368235537941,0.158265790921804,0.158138042300571,0.157999430950634,0.157844334792706,0.157688541324949,0.157535504106121,0.157392353793895,0.157265192495359,0.157163962570245,0.157081755348473,0.157029702454575,0.157011730578599,0.157026805805004,0.157075037093463,0.157156634584773,0.157265074970161,0.157401776170977,0.157553863412743,0.157723973317626,0.157885057855410,0.158050753545021,0.158191816677950,0.158314273069202,0.158409562225478,0.158464549181561,0.158483585474265,0.158466037311446,0.158412839920116,0.158327736674807,0.158211956457568,0.158077064660338,0.157932453197772,0.157775725378801,0.157622071384652,0.157475532919435,0.157333535353933,0.157217707514391,0.157124805210521,0.157055468477071,0.157017546395852,0.157014244822287,0.157043455703319,0.157105908531118,0.157199964905581,0.157323658048952,0.157466817287443,0.157628939972831,0.157790369716467,0.157958180124302,0.158112809492445,0.158250521271577,0.158358607748479,0.158437217364458,0.158477170058722,0.158480532754091,0.158447483630848,0.158379747863068,0.158282100491202,0.158155529162894,0.158019820265131,0.157867256978560];
%bf_contrast_kinematical_5A_2B(70,:);
% Probe at 300 nm in

dyn_5A_2B = [0.149481144878426,0.147551195858684,0.148580453269781,0.150435847517809,0.151612041120693,0.149682833163423,0.142235752132703,0.127997579024563,0.107196593124616,0.118954759629885,0.136354411538987,0.146875630504281,0.151123880533007,0.151068074241682,0.149280734130078,0.147749233351682,0.148365567296757,0.150673258738591,0.152963957285698,0.153036444005465,0.148217083406537,0.136592790194291,0.117702549058854,0.116808242726523,0.136032677498290,0.147997978634610,0.153089253200350,0.153167914415854,0.150910972566097,0.148566006320349,0.147835492581966,0.149336962032989,0.151149608397959,0.151321687176061,0.147274539508363,0.136988583634177,0.119807335631489,0.106261855157199,0.127233335342657,0.141702981224757,0.149377782195666,0.151476130012058,0.150374765820231,0.148515532950083,0.147331055720640,0.149259407086864,0.151762744530858,0.153424707342194,0.151711852336268,0.144130168422168,0.129357133509163,0.107897570147805,0.125892590328910,0.142062383848425,0.150944739533127,0.153585293144041,0.152333768727859,0.149822810537115,0.147861298986506,0.148361057761775,0.150165251018106,0.151571498222912,0.150248616967517,0.143701461324083,0.130456961648172,0.110505501530917,0.115942272250394,0.134286279745211,0.145786310145785,0.150838875515522,0.151240359267450,0.149555300234840,0.147906519063910,0.148113383279408,0.150306302422468,0.152711058803003,0.153265671959162,0.149292436547606,0.138704103926532];
dyn_UEM = [0.370508674335533,0.370420322691277,0.370133893347326,0.369486866698129,0.368522992929868,0.367498765881952,0.366875365332609,0.366918858596694,0.367046731752968,0.366898140501271,0.367392864878004,0.368406349450293,0.369471311852187,0.370250982705196,0.370656554985531];

% Specimen Data
Vacuum = [0.767070501587436;0.719481449922084;0.715415440080839;0.770543874506551;0.776410491217674;0.730356218000187;0.747019352050118;0.764416928560836;0.738501298534880;0.735089062700172;0.755980208964362;0.742508901870834;0.737655635439555;0.764031539369163;0.765174714001881;0.742264180211585;0.736875054539838;0.744013265371570;0.775410391978049;0.761940022003556;0.734382745295424;0.775542898714913;0.737945332275413;0.754421591185409;0.723930866651604;0.750417945999391;0.729135152324158;0.780890998222442;0.734648643132384;0.786065281151660;0.749845615216768;0.730326899824908;0.735809215812623;0.750491756817869;0.718711036751380;0.720237097645050;0.752343694773869;0.720597944315395;0.735774531046538;0.762529425591475;0.760252520802123;0.783221833557667;0.759439315940786;0.766296314454260;0.771800307714378;0.767855048129848;0.778794276904368;0.762425538496279;0.731593353251902;0.772388148342470;0.764961892893183;0.763550552307989;0.738574660503469;0.768986605142213;0.755605231255369;0.731843419421712;0.727239516592210;0.745201675781817;0.750465134669184;0.770207886575571;0.732831193975715;0.772655064354895;0.747185914650533;0.757289781643565;0.736290280388646;0.748913980129652;0.738020966118774;0.743890262712398;0.701299005647423;0.724957823527076;0.721352533078554;0.748794260782982;0.751972567317586;0.710737607345579;0.748301377937204;0.762680575175297;0.770142347669426;0.758782934442348;0.774662096846106;0.737442336008339;0.719557721324578;0.709075895924148;0.711215771856073;0.758776817368382;0.774636571647599;0.768804538869147;0.753141098377545;0.752699777792476;0.754751325237859;0.736554490668600;0.755580424405174;0.739618382229411;0.747057230410581;0.757808136711444;0.771615149480696;0.750308065653042;0.726012992565274;0.745943115832574;0.764098227356981;0.717206528475707;0.741504227493041;0.730873298287134;0.698481072308560;0.733014708293556;0.734968841714792;0.726191090036298;0.718932845220010;0.771729552386732;0.743181414108352;0.679761839268514;0.742174666421176;0.740696619501606;0.738328488545991;0.718047302390425;0.755141025090789;0.756555262753905;0.722820314355225;0.707438218692781;0.747292656106331;0.764378290133844;0.743030501111389;0.740084855698722;0.735163019028572;0.708217668178249;0.755890125682823;0.756281210220280;0.734286524130835;0.712860146543985;0.782928710921322;0.732456153154021;0.742509982297799;0.755756559750293;0.758190494244794;0.763254933411141;0.744869838830644;0.752751810492406;0.719717551096715;0.765622104051544;0.741347223188081;0.745837992476086;0.728309551131522;0.738786146549320;0.781836608943706;0.755108878397588;0.756260574040303;0.749145641395396;0.745894152320635;0.749865501433259;0.746602673363092;0.728568603679736;0.712942873353360;0.773624213504419;0.674436162316116;0.724265350564974;0.675897693585751;0.735107321009380];
Specimen = [0.155257055632459,0.146499020939649,0.145980009457265,0.159423641657523,0.155501495174699,0.144206941225000,0.148325700075225,0.151212840736832,0.149247012376327,0.152007612754195,0.147887215605732,0.147510811947780,0.149856471161082,0.151150357845127,0.143782769863808,0.143183506987832,0.144645020006510,0.151030042665942,0.156911095439305,0.149265886885717,0.151547946996172,0.156200748242061,0.145558518700518,0.144417775276488,0.139959530070930,0.140810933996704,0.139919953681084,0.143713300059370,0.135170624327915,0.149490185272191,0.144021578916573,0.125534325740460,0.133377668811519,0.148974622270078,0.144227237133173,0.139021740660576,0.120693047663098,0.115234925126583,0.119817228676457,0.138523498581299,0.135943668299417,0.145035004970664,0.128360087851422,0.107730772067133,0.116007028361006,0.132743642365289,0.138761418769719,0.118871942083684,0.0994201485261496,0.100624079845246,0.116355037558595,0.135514676820988,0.132864589531731,0.115630186053639,0.0925125263889222,0.0935167494623388,0.121863970752123,0.133196593517196,0.106168894365532,0.0980969117154261,0.0938324267092844,0.103259929845760,0.120504581026528,0.124466811328153,0.0974222051988060,0.0857167994661517,0.107722304717462,0.123077973996073,0.123921353206425,0.0963301190870794,0.101774989902603,0.101045993805455,0.120998887404512,0.121945301728545,0.110855002177800,0.0971767528413216,0.0958344036115937,0.101517776407222,0.134236783718045,0.128941673975172,0.106518447765261,0.0995142153943217,0.0988791167775064,0.125744521567041,0.139289353632629,0.122752410056623,0.100553661386892,0.0996019211260253,0.118989476780627,0.130435724087785,0.141528813660379,0.109649921914020,0.100988772914379,0.123697611890387,0.133259459589746,0.153569680044701,0.136852809307395,0.129552823981591,0.141529164753743,0.142034722779523,0.150483510728418,0.148339344720567,0.145861317640802,0.141780940175203,0.146759372834648,0.144214123216762,0.146277760192710,0.161063787100463,0.145194471519752,0.133310435202619,0.133873955264877,0.137201909479961,0.135108401057827,0.121213241975052,0.142559280880292,0.111179622430223,0.126911872651198,0.122974573344718,0.115210553007513,0.142709740291236,0.129738711427475,0.131307258986483,0.139650665072347,0.113142170936656,0.145970692969125,0.156809320379824,0.145470388342177,0.143343603303080,0.173996368422892,0.144383768638905,0.159706685125926,0.160208393092194,0.167144933547253,0.172130724224363,0.160911807154600,0.175465554474705,0.150542212940864,0.161737175683456,0.162689020166023,0.142017000340072,0.159592665727916,0.145806534588136,0.154368251636285,0.163251246610003,0.150971589009544,0.162995331538049,0.170603337909674,0.158115471379816,0.181444845264728,0.165426287581096,0.177603827540092,0.181121105735212,0.138935100123234,0.170841537297572,0.168853995839330,0.183894183566252];

% max_spec = max(Specimen);
% min_spec = min(Specimen);
% Specimen = (Specimen-min_spec)/(max_spec-min_spec);
% Specimen = Specimen - 0.05;
% probe_5A_2B = (probe_5A_2B-min_spec)/(max_spec-min_spec);
% probe_5A_2B = probe_5A_2B-max(probe_5A_2B) + 1.2;
% 
% probe_n1p79A_n2p4B = (probe_n1p79A_n2p4B-min_spec)/(max_spec-min_spec);
% probe_n1p79A_n2p4B = probe_n1p79A_n2p4B-max(probe_n1p79A_n2p4B) + 0.3;
% 
% dyn_5A_2B = (dyn_5A_2B-min_spec)/(max_spec-min_spec);
% dyn_5A_2B = dyn_5A_2B-max(dyn_5A_2B) + 1.2;
dyn_5A_2B_Arr = [dyn_5A_2B dyn_5A_2B(end-14:end) dyn_5A_2B(end-14:end)];
% 
% dyn_n1p79A_n2p4B = (dyn_n1p79A_n2p4B-min_spec)/(max_spec-min_spec);
% dyn_n1p79A_n2p4B = dyn_n1p79A_n2p4B-max(dyn_n1p79A_n2p4B) + 1.2;
dyn_UEM_Arr = [dyn_UEM dyn_UEM(end-14:end) dyn_UEM(end-14:end) dyn_UEM(end-14:end) dyn_UEM(end-14:end) dyn_UEM(end-14:end) dyn_UEM(end-14:end) dyn_UEM(end-14:end) dyn_UEM(end-14:end) dyn_UEM(end-14:end)];

%Vacuum = movmean((Vacuum-min_spec)/(max_spec-min_spec),5);

plot(0:length(kin_5A_2B)-1,kin_5A_2B+0.1,'r','linewidth',6);
hold on;
plot(0:length(kin_UEM)-1,kin_UEM-0.16,'b','linewidth',6);
plot(0:length(dyn_5A_2B_Arr)-1,dyn_5A_2B_Arr + 0.125,'r-.','linewidth',6);
plot(0:length(dyn_UEM_Arr)-1,dyn_UEM_Arr-0.1575,'b-.','linewidth',6);
%plot(Vacuum(1:end));
%plot(-73:-73+length(Specimen)-1,Specimen(1:end),'k','Linewidth',6);
%+0.0042*(-73:-73+length(Specimen)-1)
plot(-200:5:-200+5*(length(Specimen)-1),Specimen(1:end)+0.025,'k','linewidth',6);
pbaspect([1 1 1]);
xlim([0 100]);
%ylim([0.1 0.3]);
%legend({"5°" + char(945) + ", 2°" + char(946) + " kin", "-1.79°" + char(945) + ", -2.4°" + char(946) + " kin", "5°" + char(945) + ", 2°" + char(946) + " dyn", "-1.79°" + char(945) + ", -2.4°" + char(946) + " dyn", "UEM Data"},'FontSize',20,'Location','se');
set(gcf,'Position',[25 25 2500 2500]);
set(gca,'FontSize', 48);
set(gca,'LineWidth',4);
set(gca,'TickDir','out');
% yticks([0, 0.4, 0.8, 1.2]);
xlabel('Time (ps)', 'FontSize', 50);
ylabel('Intensity (offset a.u.)','FontSize', 50);
print('Simulation_Comparison','-dpng','-r300');