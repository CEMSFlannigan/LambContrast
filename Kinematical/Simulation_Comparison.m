% kinematical simulations across 2000 nm and 100 ps in 1 ps timesteps.
%bf_contrast_kinematical_-1-79A_-2-4B = ;
kin_UEM = [0.341617545670737,0.341945194566986,0.342247024554616,0.342503948786356,0.342698291122409,0.342819236398110,0.342859855375309,0.342821664559047,0.342710219945165,0.342534292999642,0.342304694631579,0.342031975863318,0.341728317830331,0.341407469237843,0.341082571986409,0.340761933008646,0.340460260103440,0.340193086383388,0.339976806495536,0.339826461168469,0.339751748311956,0.339758020184845,0.339842239633538,0.339995860232809,0.340209556280756,0.340469715822031,0.340767374005825,0.341090914132934,0.341425452800733,0.341759962009863,0.342078806972321,0.342363745016941,0.342595777478797,0.342759963075332,0.342846869825554,0.342853254969470,0.342782147100850,0.342642392368779,0.342441854682277,0.342192406856315,0.341904726854622,0.341592217333306,0.341268069664968,0.340943725935271,0.340629468177238,0.340340563746862,0.340093252724549,0.339903642425286,0.339784786704229,0.339744149157114,0.339784320857278,0.339900510837523,0.340080245887527,0.340315870708873,0.340593706491540,0.340903393828939,0.341233393300177,0.341569667894909,0.341899537736941,0.342206205393575,0.342470706789773,0.342674902310089,0.342806504653695,0.342859057386969,0.342831863784550,0.342730431847554,0.342563176361262,0.342339904591704,0.342072669993645,0.341773033065469,0.341453907007955,0.341129136405629,0.340806909337252,0.340501628797312,0.340228511258123,0.340003631202003,0.339843486654344,0.339757561405009,0.339752411171037,0.339825903876823,0.339970117356869,0.340176025018509,0.340430058803186,0.340722775306397,0.341043354449897,0.341377331152692,0.341712739836487,0.342034884513044,0.342325850393657,0.342566527789651,0.342741223610407,0.342839521218704,0.342857256428643,0.342796784016866,0.342666501119139,0.342473976556562,0.342230858017088,0.341947686320712,0.341637875127882,0.341314764052032,0.340989831554564];
kin_0A_0B = [0.332472589934901,0.332105522761228,0.331589150856374,0.330931769798162,0.330164719125747,0.329341723181528,0.328529125831302,0.327803443669292,0.327252055130778,0.326891211656082,0.327007173514057,0.327361103400399,0.327913737527796,0.328605462289225,0.329355102350934,0.330091388838763,0.330759295468035,0.331320218344066,0.331762317276158,0.332091681889709,0.332327314354958,0.332495652710653,0.332618504392309,0.332704600093502,0.332787526097478,0.332837231803243,0.332842073505235,0.332779208641504,0.332618959811371,0.332333222229302,0.331902521789268,0.331323398458948,0.330613817810330,0.329815034896198,0.328989004661758,0.328206040440559,0.327542815486026,0.327082074316719,0.326909227252857,0.327127485509832,0.327577251348881,0.328198271481802,0.328923984214536,0.329676169435228,0.330388829380449,0.331014355907055,0.331524303828662,0.331916339926241,0.332202962849669,0.332406050488196,0.332552293005351,0.332661623244826,0.332743756511243,0.332813700912080,0.332846304220286,0.332825125894871,0.332724203166909,0.332513292265330,0.332167027438908,0.331671985400644,0.331033382857389,0.330279195129550,0.329460172888168,0.328640913957920,0.327897450801767,0.327318162073135,0.326895976396269,0.326974950997156,0.327296159998437,0.327824032601329,0.328501348104005,0.329247258079950,0.329989139061124,0.330669781075454,0.331247256725209,0.331706393802020,0.332050875798402,0.332298253623384,0.332474770338563,0.332602944969651,0.332690307875054,0.332777499529146,0.332832324391462,0.332844843963113,0.332793448820992,0.332648943890190,0.332382600038967,0.331973269509304,0.331414790559144,0.330721845066170,0.329932445003415,0.329105911597878,0.328311441346614,0.327625932997986,0.327133883827151,0.326897915891119,0.327080476477882,0.327500642743288,0.328101105837319,0.328816998436361,0.329569740166119];
%bf_contrast_kinematical_5A_2B(70,:);
% Probe at 300 nm in

dyn_0A_0B = [0.376949119572373,0.377842261739721,0.379147138573256,0.380800639439873,0.382734535927595,0.384842691140814,0.386986237017578,0.389016470838165,0.387651431879384,0.385528219944248,0.383392664105514,0.381389961051487,0.379638096378923,0.378216909519322,0.377173239287863,0.377589418756553,0.378949030058547,0.380809159118790,0.383108987204904,0.385706006687098,0.388386446664176,0.390905370740328,0.390642683035158,0.388094225825593,0.385411072273157];
dyn_UEM = [0.266375763137769,0.261886787238325,0.259177391869555,0.258389927009827,0.259517276837529,0.262215707401144,0.265842706361208,0.269761921656888,0.273648681356396,0.277921828299020,0.283120064010189,0.288699028717088,0.293726278257193,0.297962838972116,0.301871688351909,0.306054311996441,0.310744261686763,0.315554950763243,0.319534684915147,0.321619015416601,0.321268389328991,0.318857405233860,0.314851598630173,0.309114906143839,0.301767343203706,0.293379088479401,0.284714151661360,0.276606647930032,0.269675980041395,0.264244612462972,0.260498144496552,0.258599297165522,0.258649477597150];

% Specimen Data
Vacuum = [0.767070501587436;0.719481449922084;0.715415440080839;0.770543874506551;0.776410491217674;0.730356218000187;0.747019352050118;0.764416928560836;0.738501298534880;0.735089062700172;0.755980208964362;0.742508901870834;0.737655635439555;0.764031539369163;0.765174714001881;0.742264180211585;0.736875054539838;0.744013265371570;0.775410391978049;0.761940022003556;0.734382745295424;0.775542898714913;0.737945332275413;0.754421591185409;0.723930866651604;0.750417945999391;0.729135152324158;0.780890998222442;0.734648643132384;0.786065281151660;0.749845615216768;0.730326899824908;0.735809215812623;0.750491756817869;0.718711036751380;0.720237097645050;0.752343694773869;0.720597944315395;0.735774531046538;0.762529425591475;0.760252520802123;0.783221833557667;0.759439315940786;0.766296314454260;0.771800307714378;0.767855048129848;0.778794276904368;0.762425538496279;0.731593353251902;0.772388148342470;0.764961892893183;0.763550552307989;0.738574660503469;0.768986605142213;0.755605231255369;0.731843419421712;0.727239516592210;0.745201675781817;0.750465134669184;0.770207886575571;0.732831193975715;0.772655064354895;0.747185914650533;0.757289781643565;0.736290280388646;0.748913980129652;0.738020966118774;0.743890262712398;0.701299005647423;0.724957823527076;0.721352533078554;0.748794260782982;0.751972567317586;0.710737607345579;0.748301377937204;0.762680575175297;0.770142347669426;0.758782934442348;0.774662096846106;0.737442336008339;0.719557721324578;0.709075895924148;0.711215771856073;0.758776817368382;0.774636571647599;0.768804538869147;0.753141098377545;0.752699777792476;0.754751325237859;0.736554490668600;0.755580424405174;0.739618382229411;0.747057230410581;0.757808136711444;0.771615149480696;0.750308065653042;0.726012992565274;0.745943115832574;0.764098227356981;0.717206528475707;0.741504227493041;0.730873298287134;0.698481072308560;0.733014708293556;0.734968841714792;0.726191090036298;0.718932845220010;0.771729552386732;0.743181414108352;0.679761839268514;0.742174666421176;0.740696619501606;0.738328488545991;0.718047302390425;0.755141025090789;0.756555262753905;0.722820314355225;0.707438218692781;0.747292656106331;0.764378290133844;0.743030501111389;0.740084855698722;0.735163019028572;0.708217668178249;0.755890125682823;0.756281210220280;0.734286524130835;0.712860146543985;0.782928710921322;0.732456153154021;0.742509982297799;0.755756559750293;0.758190494244794;0.763254933411141;0.744869838830644;0.752751810492406;0.719717551096715;0.765622104051544;0.741347223188081;0.745837992476086;0.728309551131522;0.738786146549320;0.781836608943706;0.755108878397588;0.756260574040303;0.749145641395396;0.745894152320635;0.749865501433259;0.746602673363092;0.728568603679736;0.712942873353360;0.773624213504419;0.674436162316116;0.724265350564974;0.675897693585751;0.735107321009380];
Specimen = [0.155257055632459,0.146499020939649,0.145980009457265,0.159423641657523,0.155501495174699,0.144206941225000,0.148325700075225,0.151212840736832,0.149247012376327,0.152007612754195,0.147887215605732,0.147510811947780,0.149856471161082,0.151150357845127,0.143782769863808,0.143183506987832,0.144645020006510,0.151030042665942,0.156911095439305,0.149265886885717,0.151547946996172,0.156200748242061,0.145558518700518,0.144417775276488,0.139959530070930,0.140810933996704,0.139919953681084,0.143713300059370,0.135170624327915,0.149490185272191,0.144021578916573,0.125534325740460,0.133377668811519,0.148974622270078,0.144227237133173,0.139021740660576,0.120693047663098,0.115234925126583,0.119817228676457,0.138523498581299,0.135943668299417,0.145035004970664,0.128360087851422,0.107730772067133,0.116007028361006,0.132743642365289,0.138761418769719,0.118871942083684,0.0994201485261496,0.100624079845246,0.116355037558595,0.135514676820988,0.132864589531731,0.115630186053639,0.0925125263889222,0.0935167494623388,0.121863970752123,0.133196593517196,0.106168894365532,0.0980969117154261,0.0938324267092844,0.103259929845760,0.120504581026528,0.124466811328153,0.0974222051988060,0.0857167994661517,0.107722304717462,0.123077973996073,0.123921353206425,0.0963301190870794,0.101774989902603,0.101045993805455,0.120998887404512,0.121945301728545,0.110855002177800,0.0971767528413216,0.0958344036115937,0.101517776407222,0.134236783718045,0.128941673975172,0.106518447765261,0.0995142153943217,0.0988791167775064,0.125744521567041,0.139289353632629,0.122752410056623,0.100553661386892,0.0996019211260253,0.118989476780627,0.130435724087785,0.141528813660379,0.109649921914020,0.100988772914379,0.123697611890387,0.133259459589746,0.153569680044701,0.136852809307395,0.129552823981591,0.141529164753743,0.142034722779523,0.150483510728418,0.148339344720567,0.145861317640802,0.141780940175203,0.146759372834648,0.144214123216762,0.146277760192710,0.161063787100463,0.145194471519752,0.133310435202619,0.133873955264877,0.137201909479961,0.135108401057827,0.121213241975052,0.142559280880292,0.111179622430223,0.126911872651198,0.122974573344718,0.115210553007513,0.142709740291236,0.129738711427475,0.131307258986483,0.139650665072347,0.113142170936656,0.145970692969125,0.156809320379824,0.145470388342177,0.143343603303080,0.173996368422892,0.144383768638905,0.159706685125926,0.160208393092194,0.167144933547253,0.172130724224363,0.160911807154600,0.175465554474705,0.150542212940864,0.161737175683456,0.162689020166023,0.142017000340072,0.159592665727916,0.145806534588136,0.154368251636285,0.163251246610003,0.150971589009544,0.162995331538049,0.170603337909674,0.158115471379816,0.181444845264728,0.165426287581096,0.177603827540092,0.181121105735212,0.138935100123234,0.170841537297572,0.168853995839330,0.183894183566252];

% max_spec = max(Specimen);
% min_spec = min(Specimen);
% Specimen = (Specimen-min_spec)/(max_spec-min_spec);
% Specimen = Specimen - 0.05;
% probe_5A_2B = (probe_5A_2B-min_spec)/(max_spec-min_spec);
% probe_5A_2B = probe_5A_2B-max(probe_5A_2B) + 1.2;
% 
% probe_n1p79A_n2p4B = (probe_n1p79A_n2p4B-min_spec)/(max_spec-min_spec);
% probe_n1p79A_n2p4B = probe_n1p79A_n2p4B-max(probe_n1p79A_n2p4B) + 0.3;
% 
% dyn_5A_2B = (dyn_5A_2B-min_spec)/(max_spec-min_spec);
% dyn_5A_2B = dyn_5A_2B-max(dyn_5A_2B) + 1.2;
dyn_0A_0B_Arr = [dyn_0A_0B dyn_0A_0B(end-14:end) dyn_0A_0B(end-14:end) dyn_0A_0B(end-14:end) dyn_0A_0B(end-14:end) dyn_0A_0B(end-14:end) dyn_0A_0B(end-14:end)];
% 
% dyn_n1p79A_n2p4B = (dyn_n1p79A_n2p4B-min_spec)/(max_spec-min_spec);
% dyn_n1p79A_n2p4B = dyn_n1p79A_n2p4B-max(dyn_n1p79A_n2p4B) + 1.2;
dyn_UEM_Arr = [dyn_UEM dyn_UEM(end-29:end) dyn_UEM(end-29:end) dyn_UEM(end-29:end)];

%Vacuum = movmean((Vacuum-min_spec)/(max_spec-min_spec),5);

plot(0:length(kin_0A_0B)-1,kin_0A_0B+0.01,'r','linewidth',6);
hold on;
plot(0:length(kin_UEM)-1,kin_UEM-0.09,'b','linewidth',6);
plot(0:length(dyn_0A_0B_Arr)-1,dyn_0A_0B_Arr - 0.02,'r-.','linewidth',6);
plot(0:length(dyn_UEM_Arr)-1,dyn_UEM_Arr-0.04,'b-.','linewidth',6);
%plot(Vacuum(1:end));
%plot(-73:-73+length(Specimen)-1,Specimen(1:end),'k','Linewidth',6);
%+0.0042*(-73:-73+length(Specimen)-1)
plot(-200:5:-200+length(Specimen)*5-1,Specimen(1:end)+0.04,'k','linewidth',6);
pbaspect([1 1 1]);
xlim([0 100]);
ylim([0.1 0.4]);
%legend({"5°" + char(945) + ", 2°" + char(946) + " kin", "-1.79°" + char(945) + ", -2.4°" + char(946) + " kin", "5°" + char(945) + ", 2°" + char(946) + " dyn", "-1.79°" + char(945) + ", -2.4°" + char(946) + " dyn", "UEM Data"},'FontSize',20,'Location','se');
set(gcf,'Position',[25 25 2500 2500]);
set(gca,'FontSize', 48);
set(gca,'LineWidth',4);
set(gca,'TickDir','out');
% yticks([0, 0.4, 0.8, 1.2]);
xlabel('Time (ps)', 'FontSize', 50);
ylabel('Intensity (offset a.u.)','FontSize', 50);
print('Simulation_Comparison','-dpng','-r300');