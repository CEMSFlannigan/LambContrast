widthROI = [334.746130710420,677.656801194265,649.080911987277,620.505022780290,302.087971616721,653.163181873990,693.985880741114,628.669562553715,734.808579608239,644.998642100565,563.353244366316,579.682323913166,563.353244366316,318.417051163570,653.163181873990,530.695085272617,547.024164819466,538.859625046042,563.353244366316,538.859625046042,604.175943233441,604.175943233440,465.378767085218,473.543306858643,481.707846632067,489.872386405493,481.707846632067,440.885147764943,457.214227311793,408.226988671244,440.885147764943,440.885147764943,522.530545499192,424.556068218093,408.226988671244,383.733369350969,367.404289804119,432.720607991518,359.239750030695,391.897909124394,334.746130710420,383.733369350969,391.897909124394,400.062448897819,416.391528444668,367.404289804119,391.897909124394,391.897909124394,424.556068218094,400.062448897819,351.075210257270,342.910670483845,359.239750030695,342.910670483845,220.442573882472,351.075210257270,326.581590936995,367.404289804119,318.417051163570,400.062448897819,400.062448897819,359.239750030694,318.417051163570,163.290795468497,220.442573882472,212.278034109047,204.113494335621,269.429812523021,220.442573882471,236.771653429322,236.771653429322,220.442573882472,212.278034109047,277.594352296446,253.100732976171,220.442573882472,236.771653429321,310.252511390145,122.468096601373,138.797176148223,89.8099375076736,220.442573882472,367.404289804119,163.290795468497,253.100732976171,171.455335241922,122.468096601373,138.797176148223,114.303556827948,163.290795468497,375.568829577544,195.948954562197,106.139017054523,171.455335241922,114.303556827949,171.455335241923,146.961715921648,130.632636374798,171.455335241923,244.936193202746,163.290795468497,122.468096601373,204.113494335622,204.113494335622,106.139017054523,155.126255695072,187.784414788772,163.290795468497,106.139017054523,171.455335241922,97.9744772810982,155.126255695072];
widthROI = movmean(widthROI,3);
widthROI = 2.*pi./widthROI;
timeArrROI = [190;195;200;205;210;215;220;225;230;235;240;245;250;255;260;265;270;275;280;285;290;295;300;305;310;315;320;325;330;335;340;345;350;355;360;365;370;375;380;385;390;395;400;405;410;415;420;425;430;435;440;445;450;455;460;465;470;475;480;485;490;495;500;510;520;530;540;550;560;570;580;590;600;610;620;630;640;650;660;670;680;690;700;710;720;730;740;750;760;770;780;790;800;810;820;830;840;850;860;870;880;890;900;910;920;930;940;950;960;970;980;990];

timeContrastPeaks = [-20,-15,0,5,15,20,25,30,40,45,50,60,65,75,90,95,100,105,110,115,125,135,150,165,185,195,210,220,235,245,260,275,290,300,315,330,340,355,370,385,395,410,425,435,445,460,465,470,475,480,490,495,500,510,530,540,550,560,580,590,600,620,630,640,660,670,680,700,710,720,730,740,750,770,780,790,800,820,840,860,890,900,930,950,960,970,980];
timeContrastPeaks = timeContrastPeaks(26:end-1);
ContrastPeaks = [0.127547008373927,0.140480753795483,0.134438316371817,0.142915348838742,0.132373724269726,0.137923566462050,0.133838350094124,0.146044411669694,0.135872872675232,0.137069954461272,0.133384437243886,0.144402433102827,0.129892451624185,0.141583998572557,0.127793970700379,0.137119771870106,0.131812597687117,0.139480477256702,0.129403277955053,0.150339587852911,0.121282311466561,0.146818094923094,0.117051588865247,0.140146677147021,0.107800301158922,0.139762592876439,0.0967800044516180,0.130913621682672,0.103070499168744,0.121256216859598,0.0963768758776756,0.125255554671240,0.0936302655038440,0.133932972183901,0.0962612726020038,0.130698344374879,0.0944179545103120,0.131189292984235,0.100643477541845,0.139577665445115,0.100210767039702,0.144006232686704,0.104452394637545,0.139581313275203,0.130680518488641,0.150500053371326,0.144610457566663,0.152364159291656,0.142744286594262,0.147335243664241,0.141188074331988,0.150031119199600,0.149483531235709,0.158828129654730,0.123670432225126,0.139562617875067,0.128681065894629,0.145614337199319,0.120773869972557,0.153494173280192,0.116042019631091,0.131922907114041,0.118451088688507,0.141266330667079,0.125834405804880,0.131996401066720,0.131798054674426,0.149068444687616,0.128667124118420,0.163570811478257,0.145611676383227,0.158877333803814,0.151953358923832,0.166754039287316,0.155387572751664,0.165039533374193,0.152610070771724,0.159021833628305,0.144718484834131,0.168135866314787,0.154688960886247,0.177725417996745,0.154273007667962,0.174001526543287,0.144405764937285,0.162911881862330,0.158826538000508];
ContrastPeaks = abs(diff(ContrastPeaks));
ContrastPeaks = ContrastPeaks(26:end);

plane_con = [0.0797719764464138;-3.04227974309363;0.0119215117682414];

x_plane_str = [0.00637565879067692;-0.426275381591950;0.00190346405390785];
y_plane_str = [0.00878541586227433;-0.587391299015445;0.00253813114966687];
z_plane_str = [0.00634706262775062;-0.424363447364650;0.00192010925087108];

LA_Contrast = zeros(size(ContrastPeaks));
timePeak_Indices = zeros(size(ContrastPeaks));

for i = 1:length(ContrastPeaks)
    
    for k = 1:length(timeArrROI)
        
        if timeArrROI(k) == timeContrastPeaks(i)
            timePeak_Indices(i) = k;
            LA_Contrast(i) = (ContrastPeaks(i) - plane_con(2)*widthROI(k) - plane_con(1))/plane_con(3);
        end
        
    end
    
end

figure;
subplot(1,3,1);
plot(timeContrastPeaks,LA_Contrast);
subplot(1,3,2);
plot(timeContrastPeaks,widthROI(timePeak_Indices));
subplot(1,3,3);
plot(timeContrastPeaks,ContrastPeaks);

k_vals = [0.00497, 0.0126, 0.0273];
LA_vals = [3, 6, 12];
[X,Y] = meshgrid(LA_vals(1):0.001:LA_vals(end),k_vals(1):0.001:k_vals(end));

figure;
hold on;
scatter3(widthROI(timePeak_Indices),LA_Contrast,ContrastPeaks);
surf(Y,X,plane_con(2).*Y + plane_con(3).*X + plane_con(1),'edgecolor','none');