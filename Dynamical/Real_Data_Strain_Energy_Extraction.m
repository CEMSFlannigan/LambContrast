timeSum = [0.308599085740258;0.304909358292754;0.295088588500760;0.323042950711039;0.305745662149530;0.288085841119201;0.289163427211686;0.300047954009608;0.298935332718505;0.288367001768213;0.305033878335105;0.297397198897644;0.315804060862877;0.310957128590629;0.292716655347124;0.271311582063837;0.296976141261936;0.295171351050412;0.302663323749763;0.293575207212505;0.296628734417028;0.311289259789211;0.287468716217354;0.288896528077946;0.285288844581075;0.285202353617617;0.261510057213503;0.281347505354610;0.271949757357940;0.296700859637643;0.284481736354314;0.262723287966882;0.250298366845853;0.280604115068296;0.287856572076421;0.273735786337418;0.259137806175472;0.219222413802675;0.223196085893697;0.247479827889275;0.263323681573766;0.286118885806077;0.252251212128191;0.186303314407418;0.203227551250353;0.224253157484042;0.278334753024478;0.251739219206280;0.198687449962627;0.170337602639628;0.196989232453684;0.238914180983042;0.260220174333728;0.232898249402902;0.174522307274366;0.162565931553888;0.205980668977174;0.265226133613563;0.228661504259168;0.187112534119661;0.180201234273022;0.183964088356534;0.194191666572112;0.265219859122804;0.205024340310370;0.162133264315006;0.195876560598808;0.208096253647285;0.251857419887697;0.217388521210533;0.190204916625588;0.199212011990065;0.210885213938028;0.216959515316909;0.255038299097265;0.211660915139943;0.176019835249899;0.197438868424248;0.218227568523487;0.256734560752763;0.247791711636670;0.197997350673229;0.194471780619642;0.225371218121104;0.247423552189252;0.287893923347281;0.239151513640308;0.208198615365785;0.195492559670695;0.224315796415540;0.280134862203592;0.254634353229044;0.207579098596846;0.216843079267897;0.245447942101835;0.274047199039063;0.292819135200802;0.277020520696446;0.281616519244496;0.276039942282658;0.314234221038169;0.303879935928946;0.288121077333940;0.287506888639111;0.301157020695738;0.323665706271810;0.292206555046634;0.315197764101599;0.289677005617667;0.269224411273150;0.248923973957315;0.259929408167111;0.287976147445805;0.226085736874875;0.279168175636738;0.251700156834634;0.240839231162825;0.255986447932033;0.217839878825004;0.264003311033076;0.273692646451955;0.230866868888853;0.301070069099801;0.241928176852934;0.294088584852153;0.303235589135923;0.302571639123212;0.303090678415311;0.366918169179971;0.309487728796701;0.331145489197872;0.321327044965121;0.364139084648339;0.363290429724457;0.332714259676757;0.350017426462629;0.322738312726153;0.339464077764701;0.331144099997561;0.296393068228911;0.284603480283255;0.356808704445387;0.302084119213432;0.343473147708521;0.335969049440223;0.289472984639769;0.378374661035047;0.312903850484478;0.334471683230051;0.343918182313308;0.320510386968031;0.386733792073775;0.301752366097495;0.322705876183698;0.347776432019743;0.362601986705135];
timeArr = [-30;-25;-20;-15;-10;-5;0;5;10;15;20;25;30;35;40;45;50;55;60;65;70;75;80;85;90;95;100;105;110;115;120;125;130;135;140;145;150;155;160;165;170;175;180;185;190;195;200;205;210;215;220;225;230;235;240;245;250;255;260;265;270;275;280;285;290;295;300;305;310;315;320;325;330;335;340;345;350;355;360;365;370;375;380;385;390;395;400;405;410;415;420;425;430;435;440;445;450;455;460;465;470;475;480;485;490;495;500;510;520;530;540;550;560;570;580;590;600;610;620;630;640;650;660;670;680;690;700;710;720;730;740;750;760;770;780;790;800;810;820;830;840;850;860;870;880;890;900;910;920;930;940;950;960;970;980;990];
Times = [155, 185, 215, 245, 270, 295, 320, 350, 380, 410, 430]; % ps
Frames = [38, 44, 50, 56, 61, 66, 71, 77, 83, 89, 93];
True_Center_Times = [163.463892288862,190.536980749747,218.219800181653,246.524526198439,272.829457364341,301.556420233463,326.734135667396,362.086743044190,382.766605728214,414.269662921348,438.683737646002];
Intensities = abs([-0.0446148060295972,-0.0597912953341267,-0.0627777375424791,-0.0704451084778195,-0.0606318338223980,-0.0728459629610440,-0.0523329836908451,-0.0658557202923630,-0.0510843543397645,-0.0482275613493806,-0.0466762809866073]);
%Adjuster = @(I,T) (1./(2.3102.*((T + 35) ./ (535)) + 1)).*I;
%Adjusted_Intensities = (1./(-0.3489.*((True_Center_Times + 35) ./ (535)) + 1)).*Intensities;
Adjusted_Intensities = (1./(0.283901847903401*sin(0.007214.*True_Center_Times+2.609) + 1)).*Intensities;
intensArr = Adjusted_Intensities/2;
Wavelengths = [1353.43503198545,1336.33666731775,1109.24639519090,930.488565282274,819.038446979941,757.788259090122,707.229248533078,682.332646579645,639.802354698884,561.973839792884,727.752240847567]; % nm
%Wavelengths_Px = round(Wavelengths/distanceScale); % px
Wavevectors = 2*pi./Wavelengths; % 2pi/nm

WaveData = {[47,96;48,96;42,173;43,173],[53,96;54,96;47,173;49,173],[58,96;60,96;53,173;54,173], [64,96; 66,96; 58,172; 59,173], [70,96;72,96;63,173;65,173], [76,96;79,96;68,173;70,172], [81,96;85,96;74,173;75,173], [88,96;90,96;79,172;80,173], [93,96;96,96;85,173;86,173]};
for i = 1:length(WaveData)
    curWave = WaveData{i};
    point1 = [(curWave(1,1) + curWave(2,1))/2, (curWave(1,2) + curWave(2,2))/2];
    point2 = [(curWave(3,1) + curWave(4,1))/2, (curWave(3,2) + curWave(4,2))/2];
    distanceScale = 1000*0.008862777151467; %nm 
    timeScale = 5; % ps
    curVel = (distanceScale*(point2(2) - point1(2)))/(timeScale*(point2(1) - point1(1)));
    Velocities(i) = abs(curVel);
    VelTimes(i) = True_Center_Times(i+1);
end
VelFit = @(t) 6.78+52.50.*exp(-t./208.27); % nm/ps
FitVelocities = VelFit(True_Center_Times);

Adjusted_Wavelengths = Wavelengths;% - 3.43*FitVelocities;
Adjusted_Wavevectors = 2*pi./Adjusted_Wavelengths;
kArrReal = Adjusted_Wavevectors;
Frequencies = [];%INCORRECT ARRAY, NEED TO RECALCULATE FROM LAMB_PROPERTIES[36.788, 36.789, 36.761, 36.624, 36.520, 36.435, 36.298, 36.339, 36.141, 36.232]; % GHz

WaveAmps = LA_Arr;%[6.95990542697105,11.1193651367347,12.6872114733247,15.7797960957581,12.9558532584612,17.1024810219150,10.3638013092451,13.6822566079831,9.13344570862001,7.82658578346519,7.02083650582280]; % nm^2

final_KE_fit = @(k,LA) (2.074e-13*ones(length(LA),1).*k.^(-0.8773)).*(LA'.*ones(1,length(k))).^2;
final_DE_fit = @(k,LA) (3.331e-15*ones(length(LA),1).*k.^(-1.845)).*(LA'.*ones(1,length(k))).^2;
final_SE_fit = @(k,LA) (3.925e-15*ones(length(LA),1).*k.^(-1.234)).*(LA'.*ones(1,length(k))).^2;

final_fit_intens = @(k,log_LA) 1/2*erf(0.8169*(k.^0.06642).*(log_LA'*ones(1,length(k)) - 2.709363243731673)) + 1/2;

final_fit_str_xx = @(LA) 1.259346411068840e-04.*LA'.*ones(1,length(k));
final_fit_str_yy = @(LA) 0.004189919548932.*LA'.*ones(1,length(k));
final_fit_str_xy = @(LA)  0.001306249464878.*LA'.*ones(1,length(k));

data = zeros(length(Times),6);

for i = 1:length(Times)
    data(i,:) = [final_fit_str_xx(WaveAmps(i)), final_fit_str_yy(WaveAmps(i)), final_fit_str_xy(WaveAmps(i)), final_KE_fit(Adjusted_Wavevectors(i),WaveAmps(i)), final_DE_fit(Adjusted_Wavevectors(i),WaveAmps(i)), final_SE_fit(Adjusted_Wavevectors(i),WaveAmps(i))];
end