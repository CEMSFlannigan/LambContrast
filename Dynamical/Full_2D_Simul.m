%% Setting physical constants
lambda = 2.5079e-3*1e-9; % m, 200 keV
vel = 2.0844e8; % m/s, 200 keV
theta_0 = 0.117*32^(1/3)/(200^(1/2)); % rad
beta = 0.0038; % rad
m_0 = 9.11e-31; % kg
rel_mass = 1.2674e-30;% kg
a_0 = 5.29e-11; % m
Z = 32;
E_0 = 200*1000*1.602e-19; % J, 200 keV
light = 2.9979e8; % m/s
rho = 5.323/1000*(100)^3; % kg/m^3
N_0 = 6.022e23; % atoms/mol
A = 72.64/1000; % kg/mol
gam = 1/sqrt(1-vel^2/light^2); % nondim
sigma = (Z*lambda*(a_0/(Z^0.33))*(1 + E_0/m_0/light^2))^2/(pi*a_0^2*(1+(beta/theta_0)^2));

e_charge = 1.602e-19; % C
permitiv = 8.8541878e-12; % C/V/m
planck = 6.626e-34; % Js

%% Declare variables and constants relating to electron beam travel direction
k_mag = 398; % nm^-1
rel_acc = ((k_mag*1e9)*6.626e-34)^2/2/rel_mass/e_charge; % V
g_mags = 3.06; % nm^-1 (1-1-1)
g_mags_2 = 3.06; % nm^-1 (1-11)
alpha_tilt = -8.34;
gam_tilt = 0;
beta_tilt = 4.90;
beta_add = 0;
k_unit = [0, -1, 0];
k_unit = k_unit/sqrt(dot(k_unit,k_unit));
k_alph_rot = [1,0,0;0,cosd(alpha_tilt),-sind(alpha_tilt);0,sind(alpha_tilt),cosd(alpha_tilt)];
k_gam_rot = [cosd(gam_tilt),0,sind(gam_tilt);0,1,0;-sind(gam_tilt),0,cosd(gam_tilt)];
k_beta_rot = [cosd(beta_tilt),-sind(beta_tilt),0;sind(beta_tilt),cosd(beta_tilt),0;0,0,1];
k_beta_add = [cosd(beta_add),-sind(beta_add),0;sind(beta_add),cosd(beta_add),0;0,0,1];
k_unit = k_beta_rot*k_gam_rot*k_alph_rot*k_beta_add*k_unit';

% Formerly used equation for Rutherfordian scattering (not used in this code)
frac_scatter = @(t) exp(-(N_0./A).*sigma.*rho.*t);

% Atomic scattering factor constants with parameterization via Doyle-Turner
SFa1 = 0.2135;
SFa2 = 0.9761;
SFa3 = 1.6555;
SFa4 = 2.8938;
SFa5 = 1.6356;
SFb1 = 0.0989;
SFb2 = 0.9845;
SFb3 = 4.5527;
SFb4 = 21.5563;
SFb5 = 70.3903;
Ge_ASF = @(thet) (SFa1*exp(-SFb1*(sind(thet)/(lambda*1e10)).^2) + SFa2*exp(-SFb2*(sind(thet)/(lambda*1e10)).^2) + SFa3*exp(-SFb3*(sind(thet)/(lambda*1e10)).^2) + SFa4*exp(-SFb4*(sind(thet)/(lambda*1e10)).^2) + SFa5*exp(-SFb5*(sind(thet)/(lambda*1e10)).^2)); % A

% Absorption form factor constants with parameterization via Doyle-Turner
% For T = 293 K, 200keV
AFFa1 = -0.0008;
AFFa2 = -0.0281;
AFFa3 = 0.1559;
AFFa4 = 0.0873;
AFFa5 = 0.0110;
AFFb1 = 0.0002;
AFFb2 = 0.1071;
AFFb3 = 0.5417;
AFFb4 = 1.6461;
AFFb5 = 8.4617;
DW = 0.6000;
Beta100 = (1-(1+1.9579341e-3*100)^(-2))^(-1);
Beta200 = (1-(1+1.9579341e-3*200)^(-2))^(-1);
Ge_AFF = @(thet) (AFFa1*exp(-AFFb1*(sind(thet)/(lambda*1e10)).^2) + AFFa2*exp(-AFFb2*(sind(thet)/(lambda*1e10)).^2) + AFFa3*exp(-AFFb3*(sind(thet)/(lambda*1e10)).^2) + AFFa4*exp(-AFFb4*(sind(thet)/(lambda*1e10)).^2) + AFFa5*exp(-AFFb5*(sind(thet)/(lambda*1e10)).^2))*Beta100/Beta200;
%./exp(-DW/2*(sind(thet)/(lambda*1e10)).^2)

% Crystal lattice contstants and probing dimensions used later in the code for probing strain or x-positions
latpar = 0.5658; % nm
strainpar = sqrt(dot(1/4*[1,1,1],1/4*[1,1,1]))*latpar; % nm
V_c = latpar^3;
ExtDist = @(thet,h,k,l) pi*(V_c./1e9./1e9./1e9)*cosd(thet)/lambda/(Ge_ASF(thet)/1e10)/real(Ge_SF(h,k,l));
x_spacing = 40*latpar; % nm

k_mag = sqrt(2*rel_mass*e_charge*(rel_acc + 47.87801/(V_c*10^3)*(Ge_ASF(0))))/planck*1e-9; % nm^-1
k_actual = k_unit*k_mag;

% Unit cell positions
r1 = [0, 0, 0];
r2 = [1/4, 1/4, 1/4];
r3 = [0, 1/2, 1/2];
r4 = [1/2, 0, 1/2];
r5 = [1/2, 1/2, 0];
r6 = [1/4, 3/4, 3/4];
r7 = [3/4, 1/4, 3/4];
r8 = [3/4, 3/4, 1/4];

% Diamond cubic structure factor
Ge_SF = @(ha,ka,la,r1a,r2a,r3a,r4a,r5a,r6a,r7a,r8a) exp(-2*pi*sqrt(-1)*(ha*r1a(1) + ka*r1a(2) + la*r1a(3))) + exp(-2*pi*sqrt(-1)*(ha*r2a(1) + ka*r2a(2) + la*r2a(3))) + exp(-2*pi*sqrt(-1)*(ha*r3a(1) + ka*r3a(2) + la*r3a(3))) + exp(-2*pi*sqrt(-1)*(ha*r4a(1) + ka*r4a(2) + la*r4a(3))) + exp(-2*pi*sqrt(-1)*(ha*r5a(1) + ka*r5a(2) + la*r5a(3))) + exp(-2*pi*sqrt(-1)*(ha*r6a(1) + ka*r6a(2) + la*r6a(3))) + exp(-2*pi*sqrt(-1)*(ha*r7a(1) + ka*r7a(2) + la*r7a(3))) + exp(-2*pi*sqrt(-1)*(ha*r8a(1) + ka*r8a(2) + la*r8a(3)));

% Real Fourier coefficients of the crystal lattice (elastic Bragg-Bragg scattering)
Ge_RPOT = @(thet,gx,gy,gz) 47.87801/(V_c*10^3)*(Ge_ASF(thet))*2*rel_mass*e_charge/(planck)^2./(sqrt((k_actual(1)*ones(size(gx))+gx).^2 + (k_actual(2)*ones(size(gy))+gy).^2 + (k_actual(3)*ones(size(gz))+gz).^2)*1e9);
% Imaginary Fourier coefficients of the crystal lattice (diffuse scattering, absorption)
Ge_IPOT = @(thet,gx,gy,gz) 47.87801/(V_c*10^3)*(Ge_AFF(thet))*2*rel_mass*e_charge/(planck)^2./(sqrt((k_actual(1)*ones(size(gx))+gx).^2 + (k_actual(2)*ones(size(gy))+gy).^2 + (k_actual(3)*ones(size(gz))+gz).^2)*1e9);

% Distance by which to increment along the path of the electron, assuming column approximation
thick_incr = 0.1; % nm
xy_dist_incr = sqrt(thick_incr^2*(1-k_unit(3)^2));
%xy_dist_incr = 0.0001; % nm
%dist_const = xy_dist_incr^2/(k_unit(1)^2+k_unit(2)^2);
%thick_incr = sqrt(xy_dist_incr^2 + dist_const^2*k_unit(3)^2); % nm

% Setting the initial shape of the wedge
yinit = 25; %[25 65]; % nm
xvals = 0:x_spacing:1400; % nm

% Setting the timepoints
timevals = 0:1:40; % ps
timesep = timevals(2) - timevals(1);
timetest = timesep/10;

% Setting the shape of the wedge
angle = 2/2; % degrees!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
slope = sind(angle); % nm/nm

% Setting the shape of the undisturbed surfaces of the wedge
y_top = @(x) slope*x+yinit;
y_bot = @(x) -slope*x-yinit;

% Setting distortion parameters
LambAmp = 6;%0.005;%3;%6;%4e2;%3.75e1;%3.75; % nm
k = 0.004969305039777; %.0049693; %0.010 %0.0270; % 1/nm
omega = (36.906711070799567/1e12)*2*pi; % 1/ps
VL = 5.350; % nm/ps
VT = 3.570; % nm/ps
V = 32; % nm/ps
h = 36; % nm
alpha = 0; % Set to pi/2 for asymmetric mode

p = sqrt(omega^2*(1/VL^2 - 1/V^2));
q = sqrt(omega^2*(1/VT^2 - 1/V^2));

syms x_dist(y) y_dist(y) time_space(x,t) combined_x(x,c,t,d) combined_y(x,y,t)

% Distortion in x and y
x_dist(y) = q*LambAmp*(cos(q*y+alpha) - 2*k^2/(k^2-q^2)*cos(q*h+alpha)/cos(p*h+alpha)*cos(p*y+alpha));
y_dist(y) = k*LambAmp*(sin(q*y+alpha) + 2*p*q/(k^2-q^2)*cos(q*h+alpha)/cos(p*h+alpha)*sin(p*y+alpha));
time_space(x,t) = cos(k*x-omega*t);
combined_x(x,y,t) = x_dist(y).*time_space(x,t);
combined_y(x,y,t) = y_dist(y).*time_space(x,t);

strain_matr = cell(length(xvals), length(timevals));
vel_matr = cell(length(xvals), length(timevals));

% Bragg spot basis
g_basis_1 = [1,-1,-1];
g_basis_2 = [1,-1,1];
or_z_basis = [1, g_basis_1(2), 0];
or_true_basis = [1, 0, 0];
basis_angle = acosd(dot(g_basis_1,g_basis_2)/sqrt(sum(g_basis_1.^2)*sum(g_basis_2.^2)));
orientation_z_angle = acosd(dot(g_basis_1,or_z_basis)/sqrt(sum(g_basis_1.^2)*sum(or_z_basis.^2)));
orientation_x_angle = acosd(dot(or_z_basis,or_true_basis)/sqrt(sum(or_z_basis.^2)*sum(or_true_basis.^2)));

% Orienting the first Bragg spot
g_alpha = 0;
g_beta = 1;%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
g_unit = [1, 0, 0]; % 0.0353 straight perpendicular ---> ZOLZ Weiss Zone Rule
g_unit = g_unit/sqrt(dot(g_unit,g_unit));
g_alph_rot = [cosd(g_alpha),0,sind(g_alpha);0,1,0;-sind(g_alpha),0,cosd(g_alpha)];
g_beta_rot = [cosd(g_beta),-sind(g_beta),0;sind(g_beta),cosd(g_beta),0;0,0,1];
g_unit = (g_beta_rot*g_alph_rot*g_unit')';

or_z_rot = [cosd(orientation_z_angle),-sind(orientation_z_angle),0;sind(orientation_z_angle),cosd(orientation_z_angle),0;0,0,1];
or_x_rot = [cosd(-orientation_x_angle),0,sind(-orientation_x_angle);0,1,0;-sind(-orientation_x_angle),0,cosd(-orientation_x_angle)];
true_x_dir = (or_z_rot*or_x_rot*g_unit')';
true_y_dir = ([cosd(90), -sind(90), 0; sind(90), cosd(90), 0; 0, 0, 1]*true_x_dir')';
true_z_dir = ([cosd(-90), 0, sind(-90); 0, 1, 0; -sind(-90), 0, cosd(-90)]*true_x_dir')';

% Finding the second Bragg spot basis
g_unit_2 = ([cosd(basis_angle),0,sind(basis_angle);0,1,0;-sind(basis_angle),0,cosd(basis_angle)]*g_unit')';
g_unit_2 = g_unit_2/sqrt(dot(g_unit_2,g_unit_2));

% gvec_list{1} = g_unit.*g_mags;
% gvec_list{2} = g_unit_2.*g_mags_2;
% gvec_list{3} = -g_unit.*g_mags;
% gvec_list{4} = -g_unit_2.*g_mags_2;
% 
% hvec_list{1} = g_basis_1;
% hvec_list{2} = g_basis_2;
% hvec_list{3} = -g_basis_1;
% hvec_list{4} = -g_basis_2;
% 
% % Generate Bragg spots
% [gvec_list,hvec_list] = RecipSpotGenerator(4,gvec_list,simspots,hvec_list);

hvec_list_h_master = [1,1,-1,-1,1,1,-1,-1,2,2,0,2,0,-2,-2,-2,3,3,1,3,-1,3,1,-1,-3,-3,-3,-3,4,4,2,4,0,4,-2,4,2,0,-2,-4,-4,-4,-4,-4,5,5,3,5,1,5,-1,5,-3,5,3,1,-1,-3,-5,-5,-5,-5,-5,-5,6,6,4,6,2,6,0,6,-2,6,-4,6,4,2,0,-2,-4,-6,-6,-6,-6,-6,-6,-6,7,7,5,7,3,7,1,7,-1,7,-3,7,-5,7,5,3,1,-1,-3,-5,-7,-7,-7,-7,-7,-7,-7,-7,8,8,6,8,4,8,2,8,0,8,-2,8,-4,8,-6,8,6,4,2,0,-2,-4,-6,-8,-8,-8,-8,-8,-8,-8,-8,-8,9,9,7,9,5,9,3,9,1,9,-1,9,-3,9,-5,9,-7,9,7,5,3,1,-1,-3,-5,-7,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,10,10,8,10,6,10,4,10,2,10,0,10,-2,10,-4,10,-6,10,-8,10,8,6,4,2,0,-2,-4,-6,-8,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,11,11,9,11,7,11,5,11,3,11,1,11,-1,11,-3,11,-5,11,-7,11,-9,11,9,7,5,3,1,-1,-3,-5,-7,-9,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,12,12,10,12,8,12,6,12,4,12,2,12,0,12,-2,12,-4,12,-6,12,-8,12,-10,12,10,8,6,4,2,0,-2,-4,-6,-8,-10,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,13,13,11,13,9,13,7,13,5,13,3,13,1,13,-1,13,-3,13,-5,13,-7,13,-9,13,-11,13,11,9,7,5,3,1,-1,-3,-5,-7,-9,-11,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,14,14,12,14,10,14,8,14,6,14,4,14,2,14,0,14,-2,14,-4,14,-6,14,-8,14,-10,14,-12,14,12,10,8,6,4,2,0,-2,-4,-6,-8,-10,-12,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,13,15,11,15,9,15,7,15,5,15,3,15,1,15,-1,15,-3,15,-5,15,-7,15,-9,15,-11,-13,13,11,9,7,5,3,1,-1,-3,-5,-7,-9,-11,-13,-15,-15,-15,-15,-15,-15,-15,-15,-15,-15,-15,-15,12,10,16,8,16,6,16,4,16,2,16,0,16,-2,16,-4,16,-6,16,-8,-10,-12,12,10,8,6,4,2,0,-2,-4,-6,-8,-10,-12,-16,-16,-16,-16,-16,-16,-16,-16,-16,11,9,7,5,17,3,17,1,17,-1,17,-3,-5,-7,-9,-11,11,9,7,5,3,1,-1,-3,-5,-7,-9,-11,-17,-17,-17,-17,10,8,6,4,2,0,-2,-4,-6,-8,-10,10,8,6,4,2,0,-2,-4,-6,-8,-10,9,7,5,3,1,-1,-3,-5,-7,-9,9,7,5,3,1,-1,-3,-5,-7,-9,8,6,4,2,0,-2,-4,-6,-8,8,6,4,2,0,-2,-4,-6,-8,7,5,3,1,-1,-3,-5,-7,7,5,3,1,-1,-3,-5,-7,6,4,2,0,-2,-4,-6,6,4,2,0,-2,-4,-6,5,3,1,-1,-3,-5,5,3,1,-1,-3,-5,2,0,-2,2,0,-2,2,2,0,0,3,3,1,1,3,1,-1,-1,-1,4,4,2,4,0,4,2,0,-2,-2,-2,-2,5,5,3,5,1,5,-1,5,3,1,-1,-3,-3,-3,-3,-3,6,6,4,6,2,6,0,6,-2,6,4,2,0,-2,-4,-4,-4,-4,-4,-4,7,7,5,7,3,7,1,7,-1,7,-3,7,5,3,1,-1,-3,-5,-5,-5,-5,-5,-5,-5,8,8,6,8,4,8,2,8,0,8,-2,8,-4,8,6,4,2,0,-2,-4,-6,-6,-6,-6,-6,-6,-6,-6,9,9,7,9,5,9,3,9,1,9,-1,9,-3,9,-5,9,7,5,3,1,-1,-3,-5,-7,-7,-7,-7,-7,-7,-7,-7,-7,10,10,8,10,6,10,4,10,2,10,0,10,-2,10,-4,10,-6,10,8,6,4,2,0,-2,-4,-6,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,11,11,9,11,7,11,5,11,3,11,1,11,-1,11,-3,11,-5,11,-7,11,9,7,5,3,1,-1,-3,-5,-7,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,12,12,10,12,8,12,6,12,4,12,2,12,0,12,-2,12,-4,12,-6,12,-8,12,10,8,6,4,2,0,-2,-4,-6,-8,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,13,13,11,13,9,13,7,13,5,13,3,13,1,13,-1,13,-3,13,-5,13,-7,13,-9,13,11,9,7,5,3,1,-1,-3,-5,-7,-9,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,14,14,12,14,10,14,8,14,6,14,4,14,2,14,0,14,-2,14,-4,14,-6,14,-8,14,-10,14,12,10,8,6,4,2,0,-2,-4,-6,-8,-10,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,13,15,11,15,9,15,7,15,5,15,3,15,1,15,-1,15,-3,15,-5,15,-7,15,-9,15,-11,13,11,9,7,5,3,1,-1,-3,-5,-7,-9,-11,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,12,10,16,8,16,6,16,4,16,2,16,0,16,-2,16,-4,16,-6,16,-8,-10,-12,14,12,10,8,6,4,2,0,-2,-4,-6,-8,-10,-12,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,-14,11,9,7,5,17,3,17,1,17,-1,17,-3,-5,-7,-9,-11,13,11,9,7,5,3,1,-1,-3,-5,-7,-9,-11,-13,-15,-15,-15,-15,-15,-15,-15,-15,-15,-15,-15,-15,10,8,6,4,2,0,-2,-4,-6,-8,-10,12,10,8,6,4,2,0,-2,-4,-6,-8,-10,-12,-16,-16,-16,-16,-16,-16,-16,-16,-16,9,7,5,3,1,-1,-3,-5,-7,-9,11,9,7,5,3,1,-1,-3,-5,-7,-9,-11,-17,-17,-17,-17,8,6,4,2,0,-2,-4,-6,-8,10,8,6,4,2,0,-2,-4,-6,-8,-10,7,5,3,1,-1,-3,-5,-7,9,7,5,3,1,-1,-3,-5,-7,-9,6,4,2,0,-2,-4,-6,8,6,4,2,0,-2,-4,-6,-8,5,3,1,-1,-3,-5,7,5,3,1,-1,-3,-5,-7,2,0,-2,6,4,2,0,-2,-4,-6,5,3,1,-1,-3,-5,2,0,-2];
hvec_list_k_master = [-1,-1,1,1,-1,-1,1,1,-2,-2,0,-2,0,2,2,2,-3,-3,-1,-3,1,-3,-1,1,3,3,3,3,-4,-4,-2,-4,0,-4,2,-4,-2,0,2,4,4,4,4,4,-5,-5,-3,-5,-1,-5,1,-5,3,-5,-3,-1,1,3,5,5,5,5,5,5,-6,-6,-4,-6,-2,-6,0,-6,2,-6,4,-6,-4,-2,0,2,4,6,6,6,6,6,6,6,-7,-7,-5,-7,-3,-7,-1,-7,1,-7,3,-7,5,-7,-5,-3,-1,1,3,5,7,7,7,7,7,7,7,7,-8,-8,-6,-8,-4,-8,-2,-8,0,-8,2,-8,4,-8,6,-8,-6,-4,-2,0,2,4,6,8,8,8,8,8,8,8,8,8,-9,-9,-7,-9,-5,-9,-3,-9,-1,-9,1,-9,3,-9,5,-9,7,-9,-7,-5,-3,-1,1,3,5,7,9,9,9,9,9,9,9,9,9,9,-10,-10,-8,-10,-6,-10,-4,-10,-2,-10,0,-10,2,-10,4,-10,6,-10,8,-10,-8,-6,-4,-2,0,2,4,6,8,10,10,10,10,10,10,10,10,10,10,10,-11,-11,-9,-11,-7,-11,-5,-11,-3,-11,-1,-11,1,-11,3,-11,5,-11,7,-11,9,-11,-9,-7,-5,-3,-1,1,3,5,7,9,11,11,11,11,11,11,11,11,11,11,11,11,-12,-12,-10,-12,-8,-12,-6,-12,-4,-12,-2,-12,0,-12,2,-12,4,-12,6,-12,8,-12,10,-12,-10,-8,-6,-4,-2,0,2,4,6,8,10,12,12,12,12,12,12,12,12,12,12,12,12,12,-13,-13,-11,-13,-9,-13,-7,-13,-5,-13,-3,-13,-1,-13,1,-13,3,-13,5,-13,7,-13,9,-13,11,-13,-11,-9,-7,-5,-3,-1,1,3,5,7,9,11,13,13,13,13,13,13,13,13,13,13,13,13,13,13,-14,-14,-12,-14,-10,-14,-8,-14,-6,-14,-4,-14,-2,-14,0,-14,2,-14,4,-14,6,-14,8,-14,10,-14,12,-14,-12,-10,-8,-6,-4,-2,0,2,4,6,8,10,12,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,-13,-15,-11,-15,-9,-15,-7,-15,-5,-15,-3,-15,-1,-15,1,-15,3,-15,5,-15,7,-15,9,-15,11,13,-13,-11,-9,-7,-5,-3,-1,1,3,5,7,9,11,13,15,15,15,15,15,15,15,15,15,15,15,15,-12,-10,-16,-8,-16,-6,-16,-4,-16,-2,-16,0,-16,2,-16,4,-16,6,-16,8,10,12,-12,-10,-8,-6,-4,-2,0,2,4,6,8,10,12,16,16,16,16,16,16,16,16,16,-11,-9,-7,-5,-17,-3,-17,-1,-17,1,-17,3,5,7,9,11,-11,-9,-7,-5,-3,-1,1,3,5,7,9,11,17,17,17,17,-10,-8,-6,-4,-2,0,2,4,6,8,10,-10,-8,-6,-4,-2,0,2,4,6,8,10,-9,-7,-5,-3,-1,1,3,5,7,9,-9,-7,-5,-3,-1,1,3,5,7,9,-8,-6,-4,-2,0,2,4,6,8,-8,-6,-4,-2,0,2,4,6,8,-7,-5,-3,-1,1,3,5,7,-7,-5,-3,-1,1,3,5,7,-6,-4,-2,0,2,4,6,-6,-4,-2,0,2,4,6,-5,-3,-1,1,3,5,-5,-3,-1,1,3,5,-2,0,2,-2,0,2,0,0,2,2,-1,-1,1,1,-1,1,3,3,3,-2,-2,0,-2,2,-2,0,2,4,4,4,4,-3,-3,-1,-3,1,-3,3,-3,-1,1,3,5,5,5,5,5,-4,-4,-2,-4,0,-4,2,-4,4,-4,-2,0,2,4,6,6,6,6,6,6,-5,-5,-3,-5,-1,-5,1,-5,3,-5,5,-5,-3,-1,1,3,5,7,7,7,7,7,7,7,-6,-6,-4,-6,-2,-6,0,-6,2,-6,4,-6,6,-6,-4,-2,0,2,4,6,8,8,8,8,8,8,8,8,-7,-7,-5,-7,-3,-7,-1,-7,1,-7,3,-7,5,-7,7,-7,-5,-3,-1,1,3,5,7,9,9,9,9,9,9,9,9,9,-8,-8,-6,-8,-4,-8,-2,-8,0,-8,2,-8,4,-8,6,-8,8,-8,-6,-4,-2,0,2,4,6,8,10,10,10,10,10,10,10,10,10,10,-9,-9,-7,-9,-5,-9,-3,-9,-1,-9,1,-9,3,-9,5,-9,7,-9,9,-9,-7,-5,-3,-1,1,3,5,7,9,11,11,11,11,11,11,11,11,11,11,11,-10,-10,-8,-10,-6,-10,-4,-10,-2,-10,0,-10,2,-10,4,-10,6,-10,8,-10,10,-10,-8,-6,-4,-2,0,2,4,6,8,10,12,12,12,12,12,12,12,12,12,12,12,12,-11,-11,-9,-11,-7,-11,-5,-11,-3,-11,-1,-11,1,-11,3,-11,5,-11,7,-11,9,-11,11,-11,-9,-7,-5,-3,-1,1,3,5,7,9,11,13,13,13,13,13,13,13,13,13,13,13,13,13,-12,-12,-10,-12,-8,-12,-6,-12,-4,-12,-2,-12,0,-12,2,-12,4,-12,6,-12,8,-12,10,-12,12,-12,-10,-8,-6,-4,-2,0,2,4,6,8,10,12,14,14,14,14,14,14,14,14,14,14,14,14,14,14,-11,-13,-9,-13,-7,-13,-5,-13,-3,-13,-1,-13,1,-13,3,-13,5,-13,7,-13,9,-13,11,-13,13,-11,-9,-7,-5,-3,-1,1,3,5,7,9,11,13,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,-10,-8,-14,-6,-14,-4,-14,-2,-14,0,-14,2,-14,4,-14,6,-14,8,-14,10,12,14,-12,-10,-8,-6,-4,-2,0,2,4,6,8,10,12,14,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,-9,-7,-5,-3,-15,-1,-15,1,-15,3,-15,5,7,9,11,13,-11,-9,-7,-5,-3,-1,1,3,5,7,9,11,13,15,17,17,17,17,17,17,17,17,17,17,17,17,-8,-6,-4,-2,0,2,4,6,8,10,12,-10,-8,-6,-4,-2,0,2,4,6,8,10,12,14,18,18,18,18,18,18,18,18,18,-7,-5,-3,-1,1,3,5,7,9,11,-9,-7,-5,-3,-1,1,3,5,7,9,11,13,19,19,19,19,-6,-4,-2,0,2,4,6,8,10,-8,-6,-4,-2,0,2,4,6,8,10,12,-5,-3,-1,1,3,5,7,9,-7,-5,-3,-1,1,3,5,7,9,11,-4,-2,0,2,4,6,8,-6,-4,-2,0,2,4,6,8,10,-3,-1,1,3,5,7,-5,-3,-1,1,3,5,7,9,0,2,4,-4,-2,0,2,4,6,8,-3,-1,1,3,5,7,0,2,4];
hvec_list_l_master = [-1,1,1,-1,-1,1,1,-1,-2,0,-2,2,2,2,0,-2,-3,-1,-3,1,-3,3,3,3,3,1,-1,-3,-4,-2,-4,0,-4,2,-4,4,4,4,4,4,2,0,-2,-4,-5,-3,-5,-1,-5,1,-5,3,-5,5,5,5,5,5,5,3,1,-1,-3,-5,-6,-4,-6,-2,-6,0,-6,2,-6,4,-6,6,6,6,6,6,6,6,4,2,0,-2,-4,-6,-7,-5,-7,-3,-7,-1,-7,1,-7,3,-7,5,-7,7,7,7,7,7,7,7,7,5,3,1,-1,-3,-5,-7,-8,-6,-8,-4,-8,-2,-8,0,-8,2,-8,4,-8,6,-8,8,8,8,8,8,8,8,8,8,6,4,2,0,-2,-4,-6,-8,-9,-7,-9,-5,-9,-3,-9,-1,-9,1,-9,3,-9,5,-9,7,-9,9,9,9,9,9,9,9,9,9,9,7,5,3,1,-1,-3,-5,-7,-9,-10,-8,-10,-6,-10,-4,-10,-2,-10,0,-10,2,-10,4,-10,6,-10,8,-10,10,10,10,10,10,10,10,10,10,10,10,8,6,4,2,0,-2,-4,-6,-8,-10,-11,-9,-11,-7,-11,-5,-11,-3,-11,-1,-11,1,-11,3,-11,5,-11,7,-11,9,-11,11,11,11,11,11,11,11,11,11,11,11,11,9,7,5,3,1,-1,-3,-5,-7,-9,-11,-12,-10,-12,-8,-12,-6,-12,-4,-12,-2,-12,0,-12,2,-12,4,-12,6,-12,8,-12,10,-12,12,12,12,12,12,12,12,12,12,12,12,12,12,10,8,6,4,2,0,-2,-4,-6,-8,-10,-12,-13,-11,-13,-9,-13,-7,-13,-5,-13,-3,-13,-1,-13,1,-13,3,-13,5,-13,7,-13,9,-13,11,-13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,11,9,7,5,3,1,-1,-3,-5,-7,-9,-11,-13,-14,-12,-14,-10,-14,-8,-14,-6,-14,-4,-14,-2,-14,0,-14,2,-14,4,-14,6,-14,8,-14,10,-14,12,-14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,12,10,8,6,4,2,0,-2,-4,-6,-8,-10,-12,-14,-15,-11,-15,-9,-15,-7,-15,-5,-15,-3,-15,-1,-15,1,-15,3,-15,5,-15,7,-15,9,-15,11,-15,-15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,11,9,7,5,3,1,-1,-3,-5,-7,-9,-11,-16,-16,-8,-16,-6,-16,-4,-16,-2,-16,0,-16,2,-16,4,-16,6,-16,8,-16,-16,-16,16,16,16,16,16,16,16,16,16,16,16,16,16,8,6,4,2,0,-2,-4,-6,-8,-17,-17,-17,-17,-3,-17,-1,-17,1,-17,3,-17,-17,-17,-17,-17,17,17,17,17,17,17,17,17,17,17,17,17,3,1,-1,-3,-18,-18,-18,-18,-18,-18,-18,-18,-18,-18,-18,18,18,18,18,18,18,18,18,18,18,18,-19,-19,-19,-19,-19,-19,-19,-19,-19,-19,19,19,19,19,19,19,19,19,19,19,-20,-20,-20,-20,-20,-20,-20,-20,-20,20,20,20,20,20,20,20,20,20,-21,-21,-21,-21,-21,-21,-21,-21,21,21,21,21,21,21,21,21,-22,-22,-22,-22,-22,-22,-22,22,22,22,22,22,22,22,-23,-23,-23,-23,-23,-23,23,23,23,23,23,23,-24,-24,-24,24,24,24,-1,1,1,-1,-2,0,0,-2,2,2,2,0,-2,-3,-1,-3,1,-3,3,3,3,3,1,-1,-3,-4,-2,-4,0,-4,2,-4,4,4,4,4,4,2,0,-2,-4,-5,-3,-5,-1,-5,1,-5,3,-5,5,5,5,5,5,5,3,1,-1,-3,-5,-6,-4,-6,-2,-6,0,-6,2,-6,4,-6,6,6,6,6,6,6,6,4,2,0,-2,-4,-6,-7,-5,-7,-3,-7,-1,-7,1,-7,3,-7,5,-7,7,7,7,7,7,7,7,7,5,3,1,-1,-3,-5,-7,-8,-6,-8,-4,-8,-2,-8,0,-8,2,-8,4,-8,6,-8,8,8,8,8,8,8,8,8,8,6,4,2,0,-2,-4,-6,-8,-9,-7,-9,-5,-9,-3,-9,-1,-9,1,-9,3,-9,5,-9,7,-9,9,9,9,9,9,9,9,9,9,9,7,5,3,1,-1,-3,-5,-7,-9,-10,-8,-10,-6,-10,-4,-10,-2,-10,0,-10,2,-10,4,-10,6,-10,8,-10,10,10,10,10,10,10,10,10,10,10,10,8,6,4,2,0,-2,-4,-6,-8,-10,-11,-9,-11,-7,-11,-5,-11,-3,-11,-1,-11,1,-11,3,-11,5,-11,7,-11,9,-11,11,11,11,11,11,11,11,11,11,11,11,11,9,7,5,3,1,-1,-3,-5,-7,-9,-11,-12,-10,-12,-8,-12,-6,-12,-4,-12,-2,-12,0,-12,2,-12,4,-12,6,-12,8,-12,10,-12,12,12,12,12,12,12,12,12,12,12,12,12,12,10,8,6,4,2,0,-2,-4,-6,-8,-10,-12,-13,-11,-13,-9,-13,-7,-13,-5,-13,-3,-13,-1,-13,1,-13,3,-13,5,-13,7,-13,9,-13,11,-13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,11,9,7,5,3,1,-1,-3,-5,-7,-9,-11,-13,-14,-10,-14,-8,-14,-6,-14,-4,-14,-2,-14,0,-14,2,-14,4,-14,6,-14,8,-14,10,-14,12,-14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,12,10,8,6,4,2,0,-2,-4,-6,-8,-10,-12,-14,-15,-15,-7,-15,-5,-15,-3,-15,-1,-15,1,-15,3,-15,5,-15,7,-15,9,-15,-15,-15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,13,11,9,7,5,3,1,-1,-3,-5,-7,-9,-11,-13,-16,-16,-16,-16,-2,-16,0,-16,2,-16,4,-16,-16,-16,-16,-16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,12,10,8,6,4,2,0,-2,-4,-6,-8,-10,-17,-17,-17,-17,-17,-17,-17,-17,-17,-17,-17,17,17,17,17,17,17,17,17,17,17,17,17,17,9,7,5,3,1,-1,-3,-5,-7,-18,-18,-18,-18,-18,-18,-18,-18,-18,-18,18,18,18,18,18,18,18,18,18,18,18,18,4,2,0,-2,-19,-19,-19,-19,-19,-19,-19,-19,-19,19,19,19,19,19,19,19,19,19,19,19,-20,-20,-20,-20,-20,-20,-20,-20,20,20,20,20,20,20,20,20,20,20,-21,-21,-21,-21,-21,-21,-21,21,21,21,21,21,21,21,21,21,-22,-22,-22,-22,-22,-22,22,22,22,22,22,22,22,22,-23,-23,-23,23,23,23,23,23,23,23,24,24,24,24,24,24,25,25,25];

gvec_list_h_master = [3.05953394717856,1.01984464905952,-3.05953394717856,-1.01984464905952,3.05953394717856,1.01984464905952,-3.05953394717856,-1.01984464905952,6.11906789435712,4.07937859623808,2.03968929811904,2.03968929811904,-2.03968929811904,-6.11906789435712,-4.07937859623808,-2.03968929811904,9.17860184153567,7.13891254341663,5.09922324529760,5.09922324529759,1.01984464905952,3.05953394717856,-1.01984464905952,-5.09922324529760,-9.17860184153567,-7.13891254341663,-5.09922324529759,-3.05953394717856,12.2381357887142,10.1984464905952,8.15875719247615,8.15875719247615,4.07937859623808,6.11906789435711,2.22044604925031e-15,4.07937859623807,-2.22044604925031e-15,-4.07937859623808,-8.15875719247615,-12.2381357887142,-10.1984464905952,-8.15875719247615,-6.11906789435711,-4.07937859623807,15.2976697358928,13.2579804377737,11.2182911396547,11.2182911396547,7.13891254341664,9.17860184153567,3.05953394717856,7.13891254341663,-1.01984464905952,5.09922324529759,1.01984464905952,-3.05953394717856,-7.13891254341664,-11.2182911396547,-15.2976697358928,-13.2579804377737,-11.2182911396547,-9.17860184153567,-7.13891254341663,-5.09922324529759,18.3572036830713,16.3175143849523,14.2778250868333,14.2778250868333,10.1984464905952,12.2381357887142,6.11906789435712,10.1984464905952,2.03968929811904,8.15875719247615,-2.03968929811903,6.11906789435711,2.03968929811903,-2.03968929811904,-6.11906789435712,-10.1984464905952,-14.2778250868333,-18.3572036830713,-16.3175143849523,-14.2778250868333,-12.2381357887142,-10.1984464905952,-8.15875719247615,-6.11906789435711,21.4167376302499,19.3770483321309,17.3373590340118,17.3373590340118,13.2579804377738,15.2976697358928,9.17860184153568,13.2579804377737,5.09922324529760,11.2182911396547,1.01984464905952,9.17860184153567,-3.05953394717855,7.13891254341663,3.05953394717855,-1.01984464905952,-5.09922324529760,-9.17860184153568,-13.2579804377738,-17.3373590340118,-21.4167376302499,-19.3770483321309,-17.3373590340118,-15.2976697358928,-13.2579804377737,-11.2182911396547,-9.17860184153567,-7.13891254341663,24.4762715774285,22.4365822793094,20.3968929811904,20.3968929811904,16.3175143849523,18.3572036830713,12.2381357887142,16.3175143849523,8.15875719247616,14.2778250868333,4.07937859623808,12.2381357887142,5.77315972805081e-15,10.1984464905952,-4.07937859623807,8.15875719247615,4.07937859623807,-5.32907051820075e-15,-4.07937859623808,-8.15875719247616,-12.2381357887142,-16.3175143849523,-20.3968929811904,-24.4762715774285,-22.4365822793094,-20.3968929811904,-18.3572036830713,-16.3175143849523,-14.2778250868333,-12.2381357887142,-10.1984464905952,-8.15875719247615,27.5358055246070,25.4961162264880,23.4564269283689,23.4564269283689,19.3770483321309,21.4167376302499,15.2976697358928,19.3770483321309,11.2182911396547,17.3373590340118,7.13891254341664,15.2976697358928,3.05953394717856,13.2579804377737,-1.01984464905951,11.2182911396547,-5.09922324529759,9.17860184153567,5.09922324529759,1.01984464905951,-3.05953394717856,-7.13891254341664,-11.2182911396547,-15.2976697358928,-19.3770483321309,-23.4564269283689,-27.5358055246070,-25.4961162264880,-23.4564269283689,-21.4167376302499,-19.3770483321309,-17.3373590340118,-15.2976697358928,-13.2579804377737,-11.2182911396547,-9.17860184153567,30.5953394717856,28.5556501736665,26.5159608755475,26.5159608755475,22.4365822793094,24.4762715774285,18.3572036830713,22.4365822793094,14.2778250868333,20.3968929811904,10.1984464905952,18.3572036830713,6.11906789435712,16.3175143849523,2.03968929811905,14.2778250868333,-2.03968929811903,12.2381357887142,-6.11906789435711,10.1984464905952,6.11906789435711,2.03968929811903,-2.03968929811904,-6.11906789435712,-10.1984464905952,-14.2778250868333,-18.3572036830713,-22.4365822793094,-26.5159608755475,-30.5953394717856,-28.5556501736665,-26.5159608755475,-24.4762715774285,-22.4365822793094,-20.3968929811904,-18.3572036830713,-16.3175143849523,-14.2778250868333,-12.2381357887142,-10.1984464905952,33.6548734189641,31.6151841208451,29.5754948227261,29.5754948227261,25.4961162264880,27.5358055246070,21.4167376302499,25.4961162264880,17.3373590340118,23.4564269283689,13.2579804377738,21.4167376302499,9.17860184153568,19.3770483321309,5.09922324529760,17.3373590340118,1.01984464905953,15.2976697358928,-3.05953394717855,13.2579804377737,-7.13891254341663,11.2182911396547,7.13891254341663,3.05953394717855,-1.01984464905953,-5.09922324529760,-9.17860184153568,-13.2579804377738,-17.3373590340118,-21.4167376302499,-25.4961162264880,-29.5754948227261,-33.6548734189641,-31.6151841208451,-29.5754948227261,-27.5358055246070,-25.4961162264880,-23.4564269283689,-21.4167376302499,-19.3770483321309,-17.3373590340118,-15.2976697358928,-13.2579804377737,-11.2182911396547,36.7144073661427,34.6747180680237,32.6350287699046,32.6350287699046,28.5556501736665,30.5953394717856,24.4762715774285,28.5556501736665,20.3968929811904,26.5159608755475,16.3175143849523,24.4762715774285,12.2381357887142,22.4365822793094,8.15875719247616,20.3968929811904,4.07937859623809,18.3572036830713,8.43769498715119e-15,16.3175143849523,-4.07937859623807,14.2778250868333,-8.15875719247614,12.2381357887142,8.15875719247614,4.07937859623807,-7.99360577730113e-15,-4.07937859623808,-8.15875719247616,-12.2381357887142,-16.3175143849523,-20.3968929811904,-24.4762715774285,-28.5556501736665,-32.6350287699046,-36.7144073661427,-34.6747180680237,-32.6350287699046,-30.5953394717856,-28.5556501736665,-26.5159608755475,-24.4762715774285,-22.4365822793094,-20.3968929811904,-18.3572036830713,-16.3175143849523,-14.2778250868333,-12.2381357887142,39.7739413133212,37.7342520152022,35.6945627170832,35.6945627170832,31.6151841208451,33.6548734189641,27.5358055246070,31.6151841208451,23.4564269283689,29.5754948227261,19.3770483321309,27.5358055246070,15.2976697358928,25.4961162264880,11.2182911396547,23.4564269283689,7.13891254341664,21.4167376302499,3.05953394717857,19.3770483321309,-1.01984464905951,17.3373590340118,-5.09922324529759,15.2976697358928,-9.17860184153566,13.2579804377737,9.17860184153566,5.09922324529759,1.01984464905951,-3.05953394717857,-7.13891254341664,-11.2182911396547,-15.2976697358928,-19.3770483321309,-23.4564269283689,-27.5358055246070,-31.6151841208451,-35.6945627170832,-39.7739413133212,-37.7342520152022,-35.6945627170832,-33.6548734189641,-31.6151841208451,-29.5754948227261,-27.5358055246070,-25.4961162264880,-23.4564269283689,-21.4167376302499,-19.3770483321309,-17.3373590340118,-15.2976697358928,-13.2579804377737,42.8334752604998,40.7937859623808,38.7540966642617,38.7540966642617,34.6747180680236,36.7144073661427,30.5953394717856,34.6747180680237,26.5159608755475,32.6350287699046,22.4365822793094,30.5953394717856,18.3572036830714,28.5556501736665,14.2778250868333,26.5159608755475,10.1984464905952,24.4762715774285,6.11906789435713,22.4365822793094,2.03968929811905,20.3968929811904,-2.03968929811903,18.3572036830713,-6.11906789435710,16.3175143849523,-10.1984464905952,14.2778250868333,10.1984464905952,6.11906789435710,2.03968929811903,-2.03968929811905,-6.11906789435712,-10.1984464905952,-14.2778250868333,-18.3572036830714,-22.4365822793094,-26.5159608755475,-30.5953394717856,-34.6747180680237,-38.7540966642617,-42.8334752604998,-40.7937859623808,-38.7540966642617,-36.7144073661427,-34.6747180680237,-32.6350287699046,-30.5953394717856,-28.5556501736665,-26.5159608755475,-24.4762715774285,-22.4365822793094,-20.3968929811904,-18.3572036830713,-16.3175143849523,-14.2778250868333,41.8136306114403,41.8136306114403,37.7342520152022,39.7739413133213,33.6548734189641,37.7342520152022,29.5754948227261,35.6945627170832,25.4961162264880,33.6548734189641,21.4167376302499,31.6151841208451,17.3373590340118,29.5754948227260,13.2579804377738,27.5358055246070,9.17860184153568,25.4961162264880,5.09922324529761,23.4564269283689,1.01984464905953,21.4167376302499,-3.05953394717855,19.3770483321309,-7.13891254341662,-11.2182911396547,11.2182911396547,7.13891254341662,3.05953394717855,-1.01984464905953,-5.09922324529761,-9.17860184153568,-13.2579804377738,-17.3373590340118,-21.4167376302499,-25.4961162264880,-29.5754948227261,-33.6548734189641,-37.7342520152022,-41.8136306114403,-41.8136306114403,-39.7739413133213,-37.7342520152022,-35.6945627170832,-33.6548734189641,-31.6151841208451,-29.5754948227260,-27.5358055246070,-25.4961162264880,-23.4564269283689,-21.4167376302499,-19.3770483321309,40.7937859623808,36.7144073661427,40.7937859623808,32.6350287699046,38.7540966642617,28.5556501736665,36.7144073661427,24.4762715774285,34.6747180680237,20.3968929811904,32.6350287699046,16.3175143849523,30.5953394717856,12.2381357887142,28.5556501736665,8.15875719247616,26.5159608755475,4.07937859623809,24.4762715774285,1.19904086659517e-14,-4.07937859623806,-8.15875719247614,8.15875719247614,4.07937859623806,-1.15463194561016e-14,-4.07937859623809,-8.15875719247616,-12.2381357887142,-16.3175143849523,-20.3968929811904,-24.4762715774285,-28.5556501736665,-32.6350287699046,-36.7144073661427,-40.7937859623808,-40.7937859623808,-38.7540966642617,-36.7144073661427,-34.6747180680237,-32.6350287699046,-30.5953394717856,-28.5556501736665,-26.5159608755475,-24.4762715774285,39.7739413133212,35.6945627170832,31.6151841208451,27.5358055246070,37.7342520152022,23.4564269283690,35.6945627170832,19.3770483321309,33.6548734189641,15.2976697358928,31.6151841208451,11.2182911396547,7.13891254341664,3.05953394717857,-1.01984464905951,-5.09922324529758,5.09922324529758,1.01984464905951,-3.05953394717857,-7.13891254341664,-11.2182911396547,-15.2976697358928,-19.3770483321309,-23.4564269283690,-27.5358055246070,-31.6151841208451,-35.6945627170832,-39.7739413133213,-37.7342520152022,-35.6945627170832,-33.6548734189641,-31.6151841208451,38.7540966642617,34.6747180680236,30.5953394717856,26.5159608755475,22.4365822793094,18.3572036830714,14.2778250868333,10.1984464905952,6.11906789435713,2.03968929811905,-2.03968929811902,2.03968929811902,-2.03968929811905,-6.11906789435713,-10.1984464905952,-14.2778250868333,-18.3572036830714,-22.4365822793094,-26.5159608755475,-30.5953394717856,-34.6747180680237,-38.7540966642617,37.7342520152022,33.6548734189641,29.5754948227260,25.4961162264880,21.4167376302499,17.3373590340118,13.2579804377738,9.17860184153568,5.09922324529761,1.01984464905953,-1.01984464905953,-5.09922324529761,-9.17860184153568,-13.2579804377738,-17.3373590340118,-21.4167376302499,-25.4961162264880,-29.5754948227261,-33.6548734189641,-37.7342520152022,36.7144073661427,32.6350287699046,28.5556501736665,24.4762715774285,20.3968929811904,16.3175143849523,12.2381357887142,8.15875719247617,4.07937859623809,-4.07937859623809,-8.15875719247617,-12.2381357887142,-16.3175143849523,-20.3968929811904,-24.4762715774285,-28.5556501736665,-32.6350287699046,-36.7144073661427,35.6945627170832,31.6151841208451,27.5358055246070,23.4564269283689,19.3770483321309,15.2976697358928,11.2182911396547,7.13891254341665,-7.13891254341665,-11.2182911396547,-15.2976697358928,-19.3770483321309,-23.4564269283690,-27.5358055246070,-31.6151841208451,-35.6945627170832,34.6747180680236,30.5953394717856,26.5159608755475,22.4365822793094,18.3572036830714,14.2778250868333,10.1984464905952,-10.1984464905952,-14.2778250868333,-18.3572036830714,-22.4365822793094,-26.5159608755475,-30.5953394717856,-34.6747180680237,33.6548734189641,29.5754948227260,25.4961162264880,21.4167376302499,17.3373590340118,13.2579804377738,-13.2579804377738,-17.3373590340118,-21.4167376302499,-25.4961162264880,-29.5754948227261,-33.6548734189641,28.5556501736665,24.4762715774285,20.3968929811904,-20.3968929811904,-24.4762715774285,-28.5556501736666,6.06566353065903,4.02597423253999,-0.0534043636980877,1.98628493442095,9.12519747783759,7.08550817971855,3.00612958348047,5.04581888159951,5.04581888159951,0.966440285361431,-3.11293831087665,-1.07324901275761,0.966440285361433,12.1847314250161,10.1450421268971,8.10535282877807,8.10535282877806,4.02597423253999,6.06566353065902,1.98628493442095,-2.09309366181713,-6.17247225805520,-4.13278295993616,-2.09309366181712,-0.0534043636980852,15.2442653721947,13.2045760740757,11.1648867759566,11.1648867759566,7.08550817971855,9.12519747783758,3.00612958348047,7.08550817971854,3.00612958348047,-1.07324901275761,-5.15262760899569,-9.23200620523376,-7.19231690711472,-5.15262760899568,-3.11293831087664,-1.07324901275760,18.3037993193733,16.2641100212542,14.2244207231352,14.2244207231352,10.1450421268971,12.1847314250161,6.06566353065903,10.1450421268971,1.98628493442095,8.10535282877806,4.02597423253999,-0.0534043636980908,-4.13278295993617,-8.21216155617424,-12.2915401524123,-10.2518508542933,-8.21216155617424,-6.17247225805520,-4.13278295993616,-2.09309366181712,21.3633332665518,19.3236439684328,17.2839546703137,17.2839546703137,13.2045760740757,15.2442653721947,9.12519747783759,13.2045760740757,5.04581888159951,11.1648867759566,0.966440285361436,9.12519747783758,5.04581888159950,0.966440285361428,-3.11293831087665,-7.19231690711473,-11.2716955033528,-15.3510740995909,-13.3113848014718,-11.2716955033528,-9.23200620523376,-7.19231690711472,-5.15262760899568,-3.11293831087664,24.4228672137304,22.3831779156113,20.3434886174923,20.3434886174923,16.2641100212542,18.3037993193733,12.1847314250161,16.2641100212542,8.10535282877807,14.2244207231352,4.02597423253999,12.1847314250161,-0.0534043636980825,10.1450421268971,6.06566353065902,1.98628493442095,-2.09309366181713,-6.17247225805521,-10.2518508542933,-14.3312294505314,-18.4106080467694,-16.3709187486504,-14.3312294505314,-12.2915401524123,-10.2518508542933,-8.21216155617424,-6.17247225805520,-4.13278295993616,27.4824011609089,25.4427118627899,23.4030225646709,23.4030225646709,19.3236439684328,21.3633332665518,15.2442653721947,19.3236439684328,11.1648867759566,17.2839546703137,7.08550817971855,15.2442653721947,3.00612958348048,13.2045760740757,-1.07324901275760,11.1648867759566,7.08550817971854,3.00612958348046,-1.07324901275761,-5.15262760899569,-9.23200620523376,-13.3113848014718,-17.3907633977099,-21.4701419939480,-19.4304526958290,-17.3907633977099,-15.3510740995909,-13.3113848014718,-11.2716955033528,-9.23200620523375,-7.19231690711472,-5.15262760899568,30.5419351080875,28.5022458099685,26.4625565118494,26.4625565118494,22.3831779156113,24.4228672137304,18.3037993193733,22.3831779156113,14.2244207231352,20.3434886174923,10.1450421268971,18.3037993193733,6.06566353065903,16.2641100212542,1.98628493442096,14.2244207231352,-2.09309366181712,12.1847314250161,8.10535282877806,4.02597423253998,-0.0534043636980934,-4.13278295993617,-8.21216155617424,-12.2915401524123,-16.3709187486504,-20.4502973448885,-24.5296759411266,-22.4899866430075,-20.4502973448885,-18.4106080467694,-16.3709187486504,-14.3312294505314,-12.2915401524123,-10.2518508542933,-8.21216155617423,-6.17247225805519,33.6014690552660,31.5617797571470,29.5220904590280,29.5220904590280,25.4427118627899,27.4824011609089,21.3633332665518,25.4427118627899,17.2839546703137,23.4030225646709,13.2045760740757,21.3633332665518,9.12519747783759,19.3236439684328,5.04581888159952,17.2839546703137,0.966440285361439,15.2442653721947,-3.11293831087664,13.2045760740757,9.12519747783758,5.04581888159950,0.966440285361424,-3.11293831087665,-7.19231690711473,-11.2716955033528,-15.3510740995909,-19.4304526958290,-23.5098312920670,-27.5892098883051,-25.5495205901861,-23.5098312920670,-21.4701419939480,-19.4304526958290,-17.3907633977099,-15.3510740995909,-13.3113848014718,-11.2716955033528,-9.23200620523375,-7.19231690711471,36.6610030024446,34.6213137043256,32.5816244062065,32.5816244062065,28.5022458099685,30.5419351080875,24.4228672137304,28.5022458099684,20.3434886174923,26.4625565118494,16.2641100212542,24.4228672137304,12.1847314250162,22.3831779156113,8.10535282877807,20.3434886174923,4.02597423254000,18.3037993193732,-0.0534043636980790,16.2641100212542,-4.13278295993616,14.2244207231352,10.1450421268971,6.06566353065902,1.98628493442094,-2.09309366181713,-6.17247225805521,-10.2518508542933,-14.3312294505314,-18.4106080467694,-22.4899866430075,-26.5693652392456,-30.6487438354837,-28.6090545373646,-26.5693652392456,-24.5296759411265,-22.4899866430075,-20.4502973448885,-18.4106080467694,-16.3709187486504,-14.3312294505313,-12.2915401524123,-10.2518508542933,-8.21216155617423,39.7205369496232,37.6808476515041,35.6411583533851,35.6411583533851,31.5617797571470,33.6014690552661,27.4824011609089,31.5617797571470,23.4030225646709,29.5220904590280,19.3236439684328,27.4824011609089,15.2442653721947,25.4427118627899,11.1648867759566,23.4030225646708,7.08550817971856,21.3633332665518,3.00612958348048,19.3236439684328,-1.07324901275760,17.2839546703137,-5.15262760899567,15.2442653721947,11.1648867759566,7.08550817971854,3.00612958348046,-1.07324901275762,-5.15262760899569,-9.23200620523377,-13.3113848014718,-17.3907633977099,-21.4701419939480,-25.5495205901861,-29.6288991864241,-33.7082777826622,-31.6685884845432,-29.6288991864241,-27.5892098883051,-25.5495205901861,-23.5098312920670,-21.4701419939480,-19.4304526958289,-17.3907633977099,-15.3510740995909,-13.3113848014718,-11.2716955033528,-9.23200620523375,42.7800708968017,40.7403815986827,38.7006923005636,38.7006923005636,34.6213137043256,36.6610030024446,30.5419351080875,34.6213137043256,26.4625565118494,32.5816244062065,22.3831779156113,30.5419351080875,18.3037993193733,28.5022458099684,14.2244207231352,26.4625565118494,10.1450421268971,24.4228672137304,6.06566353065904,22.3831779156113,1.98628493442096,20.3434886174923,-2.09309366181712,18.3037993193732,-6.17247225805519,16.2641100212542,12.1847314250161,8.10535282877805,4.02597423253998,-0.0534043636980970,-4.13278295993617,-8.21216155617425,-12.2915401524123,-16.3709187486504,-20.4502973448885,-24.5296759411266,-28.6090545373646,-32.6884331336027,-36.7678117298408,-34.7281224317217,-32.6884331336027,-30.6487438354837,-28.6090545373646,-26.5693652392456,-24.5296759411265,-22.4899866430075,-20.4502973448885,-18.4106080467694,-16.3709187486504,-14.3312294505313,-12.2915401524123,-10.2518508542933,41.7602262477422,41.7602262477422,37.6808476515041,39.7205369496232,33.6014690552660,37.6808476515041,29.5220904590280,35.6411583533851,25.4427118627899,33.6014690552660,21.3633332665518,31.5617797571470,17.2839546703137,29.5220904590280,13.2045760740757,27.4824011609089,9.12519747783760,25.4427118627899,5.04581888159952,23.4030225646708,0.966440285361443,21.3633332665518,-3.11293831087663,19.3236439684328,-7.19231690711471,13.2045760740757,9.12519747783757,5.04581888159950,0.966440285361421,-3.11293831087665,-7.19231690711473,-11.2716955033528,-15.3510740995909,-19.4304526958290,-23.5098312920670,-27.5892098883051,-31.6685884845432,-35.7479670807813,-39.8273456770193,-37.7876563789003,-35.7479670807813,-33.7082777826622,-31.6685884845432,-29.6288991864241,-27.5892098883051,-25.5495205901861,-23.5098312920670,-21.4701419939480,-19.4304526958289,-17.3907633977099,-15.3510740995909,-13.3113848014718,-11.2716955033528,40.7403815986827,36.6610030024446,40.7403815986827,32.5816244062065,38.7006923005637,28.5022458099685,36.6610030024446,24.4228672137304,34.6213137043256,20.3434886174923,32.5816244062065,16.2641100212542,30.5419351080875,12.1847314250162,28.5022458099684,8.10535282877808,26.4625565118494,4.02597423254000,24.4228672137304,-0.0534043636980754,-4.13278295993615,-8.21216155617423,14.2244207231352,10.1450421268971,6.06566353065901,1.98628493442094,-2.09309366181714,-6.17247225805521,-10.2518508542933,-14.3312294505314,-18.4106080467694,-22.4899866430075,-26.5693652392456,-30.6487438354837,-34.7281224317217,-38.8075010279598,-42.8868796241979,-40.8471903260789,-38.8075010279598,-36.7678117298408,-34.7281224317217,-32.6884331336027,-30.6487438354837,-28.6090545373646,-26.5693652392456,-24.5296759411265,-22.4899866430075,-20.4502973448885,-18.4106080467694,-16.3709187486504,-14.3312294505313,39.7205369496232,35.6411583533851,31.5617797571470,27.4824011609089,37.6808476515041,23.4030225646709,35.6411583533851,19.3236439684328,33.6014690552660,15.2442653721947,31.5617797571470,11.1648867759566,7.08550817971856,3.00612958348048,-1.07324901275759,-5.15262760899567,11.1648867759566,7.08550817971853,3.00612958348046,-1.07324901275762,-5.15262760899569,-9.23200620523377,-13.3113848014718,-17.3907633977099,-21.4701419939480,-25.5495205901861,-29.6288991864242,-33.7082777826622,-37.7876563789003,-41.8670349751384,-41.8670349751384,-39.8273456770193,-37.7876563789003,-35.7479670807813,-33.7082777826622,-31.6685884845432,-29.6288991864241,-27.5892098883051,-25.5495205901861,-23.5098312920670,-21.4701419939480,-19.4304526958289,38.7006923005636,34.6213137043256,30.5419351080875,26.4625565118494,22.3831779156113,18.3037993193733,14.2244207231352,10.1450421268971,6.06566353065904,1.98628493442096,-2.09309366181711,8.10535282877805,4.02597423253998,-0.0534043636981005,-4.13278295993618,-8.21216155617425,-12.2915401524123,-16.3709187486504,-20.4502973448885,-24.5296759411266,-28.6090545373646,-32.6884331336027,-36.7678117298408,-40.8471903260789,-40.8471903260789,-38.8075010279598,-36.7678117298408,-34.7281224317217,-32.6884331336027,-30.6487438354837,-28.6090545373646,-26.5693652392456,-24.5296759411265,37.6808476515041,33.6014690552660,29.5220904590280,25.4427118627899,21.3633332665518,17.2839546703138,13.2045760740757,9.12519747783760,5.04581888159952,0.966440285361446,5.04581888159949,0.966440285361419,-3.11293831087666,-7.19231690711473,-11.2716955033528,-15.3510740995909,-19.4304526958290,-23.5098312920670,-27.5892098883051,-31.6685884845432,-35.7479670807813,-39.8273456770193,-37.7876563789003,-35.7479670807813,-33.7082777826622,-31.6685884845432,36.6610030024446,32.5816244062065,28.5022458099684,24.4228672137304,20.3434886174923,16.2641100212542,12.1847314250162,8.10535282877808,4.02597423254001,1.98628493442094,-2.09309366181714,-6.17247225805522,-10.2518508542933,-14.3312294505314,-18.4106080467694,-22.4899866430075,-26.5693652392456,-30.6487438354837,-34.7281224317217,-38.8075010279598,35.6411583533851,31.5617797571470,27.4824011609089,23.4030225646709,19.3236439684328,15.2442653721947,11.1648867759566,7.08550817971856,-1.07324901275762,-5.15262760899570,-9.23200620523377,-13.3113848014719,-17.3907633977099,-21.4701419939480,-25.5495205901861,-29.6288991864242,-33.7082777826622,-37.7876563789003,34.6213137043255,30.5419351080875,26.4625565118494,22.3831779156113,18.3037993193733,14.2244207231352,10.1450421268971,-4.13278295993618,-8.21216155617425,-12.2915401524123,-16.3709187486504,-20.4502973448885,-24.5296759411266,-28.6090545373646,-32.6884331336027,-36.7678117298408,33.6014690552660,29.5220904590280,25.4427118627899,21.3633332665518,17.2839546703138,13.2045760740757,-7.19231690711474,-11.2716955033528,-15.3510740995909,-19.4304526958290,-23.5098312920670,-27.5892098883051,-31.6685884845432,-35.7479670807813,28.5022458099684,24.4228672137304,20.3434886174923,-10.2518508542933,-14.3312294505314,-18.4106080467694,-22.4899866430075,-26.5693652392456,-30.6487438354837,-34.7281224317218,-13.3113848014719,-17.3907633977099,-21.4701419939480,-25.5495205901861,-29.6288991864242,-33.7082777826622,-20.4502973448885,-24.5296759411266,-28.6090545373646];
gvec_list_k_master = [0.0534043636980876,0.0534043636980876,-0.0534043636980876,-0.0534043636980876,0.0534043636980876,0.0534043636980876,-0.0534043636980876,-0.0534043636980876,0.106808727396175,0.106808727396175,0,0.106808727396175,0,-0.106808727396175,-0.106808727396175,-0.106808727396175,0.160213091094263,0.160213091094263,0.0534043636980876,0.160213091094263,-0.0534043636980876,0.160213091094263,0.0534043636980876,-0.0534043636980876,-0.160213091094263,-0.160213091094263,-0.160213091094263,-0.160213091094263,0.213617454792350,0.213617454792350,0.106808727396175,0.213617454792350,0,0.213617454792350,-0.106808727396175,0.213617454792350,0.106808727396175,0,-0.106808727396175,-0.213617454792350,-0.213617454792350,-0.213617454792350,-0.213617454792350,-0.213617454792350,0.267021818490438,0.267021818490438,0.160213091094263,0.267021818490438,0.0534043636980876,0.267021818490438,-0.0534043636980876,0.267021818490438,-0.160213091094263,0.267021818490438,0.160213091094263,0.0534043636980876,-0.0534043636980876,-0.160213091094263,-0.267021818490438,-0.267021818490438,-0.267021818490438,-0.267021818490438,-0.267021818490438,-0.267021818490438,0.320426182188525,0.320426182188525,0.213617454792350,0.320426182188525,0.106808727396175,0.320426182188525,1.38777878078145e-17,0.320426182188525,-0.106808727396175,0.320426182188525,-0.213617454792350,0.320426182188525,0.213617454792350,0.106808727396175,1.38777878078145e-17,-0.106808727396175,-0.213617454792350,-0.320426182188525,-0.320426182188525,-0.320426182188525,-0.320426182188525,-0.320426182188525,-0.320426182188525,-0.320426182188525,0.373830545886613,0.373830545886613,0.267021818490438,0.373830545886613,0.160213091094263,0.373830545886613,0.0534043636980876,0.373830545886613,-0.0534043636980875,0.373830545886613,-0.160213091094263,0.373830545886613,-0.267021818490438,0.373830545886613,0.267021818490438,0.160213091094263,0.0534043636980876,-0.0534043636980875,-0.160213091094263,-0.267021818490438,-0.373830545886613,-0.373830545886613,-0.373830545886613,-0.373830545886613,-0.373830545886613,-0.373830545886613,-0.373830545886613,-0.373830545886613,0.427234909584700,0.427234909584700,0.320426182188525,0.427234909584700,0.213617454792350,0.427234909584700,0.106808727396175,0.427234909584700,1.38777878078145e-17,0.427234909584700,-0.106808727396175,0.427234909584700,-0.213617454792350,0.427234909584700,-0.320426182188525,0.427234909584700,0.320426182188525,0.213617454792350,0.106808727396175,1.38777878078145e-17,-0.106808727396175,-0.213617454792350,-0.320426182188525,-0.427234909584700,-0.427234909584700,-0.427234909584700,-0.427234909584700,-0.427234909584700,-0.427234909584700,-0.427234909584700,-0.427234909584700,-0.427234909584700,0.480639273282788,0.480639273282788,0.373830545886613,0.480639273282788,0.267021818490438,0.480639273282788,0.160213091094263,0.480639273282788,0.0534043636980876,0.480639273282788,-0.0534043636980875,0.480639273282788,-0.160213091094263,0.480639273282788,-0.267021818490438,0.480639273282788,-0.373830545886613,0.480639273282788,0.373830545886613,0.267021818490438,0.160213091094263,0.0534043636980876,-0.0534043636980875,-0.160213091094263,-0.267021818490438,-0.373830545886613,-0.480639273282788,-0.480639273282788,-0.480639273282788,-0.480639273282788,-0.480639273282788,-0.480639273282788,-0.480639273282788,-0.480639273282788,-0.480639273282788,-0.480639273282788,0.534043636980876,0.534043636980876,0.427234909584700,0.534043636980876,0.320426182188525,0.534043636980876,0.213617454792350,0.534043636980876,0.106808727396175,0.534043636980876,4.16333634234434e-17,0.534043636980876,-0.106808727396175,0.534043636980876,-0.213617454792350,0.534043636980876,-0.320426182188525,0.534043636980876,-0.427234909584700,0.534043636980876,0.427234909584700,0.320426182188525,0.213617454792350,0.106808727396175,4.16333634234434e-17,-0.106808727396175,-0.213617454792350,-0.320426182188525,-0.427234909584700,-0.534043636980876,-0.534043636980876,-0.534043636980876,-0.534043636980876,-0.534043636980876,-0.534043636980876,-0.534043636980876,-0.534043636980876,-0.534043636980876,-0.534043636980876,-0.534043636980876,0.587448000678963,0.587448000678963,0.480639273282788,0.587448000678963,0.373830545886613,0.587448000678963,0.267021818490438,0.587448000678963,0.160213091094263,0.587448000678963,0.0534043636980876,0.587448000678963,-0.0534043636980875,0.587448000678963,-0.160213091094263,0.587448000678963,-0.267021818490438,0.587448000678963,-0.373830545886613,0.587448000678963,-0.480639273282788,0.587448000678963,0.480639273282788,0.373830545886613,0.267021818490438,0.160213091094263,0.0534043636980876,-0.0534043636980875,-0.160213091094263,-0.267021818490438,-0.373830545886613,-0.480639273282788,-0.587448000678963,-0.587448000678963,-0.587448000678963,-0.587448000678963,-0.587448000678963,-0.587448000678963,-0.587448000678963,-0.587448000678963,-0.587448000678963,-0.587448000678963,-0.587448000678963,-0.587448000678963,0.640852364377051,0.640852364377051,0.534043636980876,0.640852364377051,0.427234909584700,0.640852364377051,0.320426182188525,0.640852364377051,0.213617454792350,0.640852364377051,0.106808727396175,0.640852364377051,4.16333634234434e-17,0.640852364377051,-0.106808727396175,0.640852364377051,-0.213617454792350,0.640852364377051,-0.320426182188525,0.640852364377051,-0.427234909584700,0.640852364377051,-0.534043636980876,0.640852364377051,0.534043636980876,0.427234909584700,0.320426182188525,0.213617454792350,0.106808727396175,4.16333634234434e-17,-0.106808727396175,-0.213617454792350,-0.320426182188525,-0.427234909584700,-0.534043636980876,-0.640852364377051,-0.640852364377051,-0.640852364377051,-0.640852364377051,-0.640852364377051,-0.640852364377051,-0.640852364377051,-0.640852364377051,-0.640852364377051,-0.640852364377051,-0.640852364377051,-0.640852364377051,-0.640852364377051,0.694256728075138,0.694256728075138,0.587448000678963,0.694256728075138,0.480639273282788,0.694256728075138,0.373830545886613,0.694256728075138,0.267021818490438,0.694256728075138,0.160213091094263,0.694256728075138,0.0534043636980876,0.694256728075138,-0.0534043636980875,0.694256728075138,-0.160213091094263,0.694256728075138,-0.267021818490438,0.694256728075138,-0.373830545886613,0.694256728075138,-0.480639273282788,0.694256728075138,-0.587448000678963,0.694256728075138,0.587448000678963,0.480639273282788,0.373830545886613,0.267021818490438,0.160213091094263,0.0534043636980876,-0.0534043636980875,-0.160213091094263,-0.267021818490438,-0.373830545886613,-0.480639273282788,-0.587448000678963,-0.694256728075138,-0.694256728075138,-0.694256728075138,-0.694256728075138,-0.694256728075138,-0.694256728075138,-0.694256728075138,-0.694256728075138,-0.694256728075138,-0.694256728075138,-0.694256728075138,-0.694256728075138,-0.694256728075138,-0.694256728075138,0.747661091773226,0.747661091773226,0.640852364377051,0.747661091773226,0.534043636980876,0.747661091773226,0.427234909584700,0.747661091773226,0.320426182188525,0.747661091773226,0.213617454792350,0.747661091773226,0.106808727396175,0.747661091773226,4.16333634234434e-17,0.747661091773226,-0.106808727396175,0.747661091773226,-0.213617454792350,0.747661091773226,-0.320426182188525,0.747661091773226,-0.427234909584700,0.747661091773226,-0.534043636980876,0.747661091773226,-0.640852364377051,0.747661091773226,0.640852364377051,0.534043636980876,0.427234909584700,0.320426182188525,0.213617454792350,0.106808727396175,4.16333634234434e-17,-0.106808727396175,-0.213617454792350,-0.320426182188525,-0.427234909584700,-0.534043636980876,-0.640852364377051,-0.747661091773226,-0.747661091773226,-0.747661091773226,-0.747661091773226,-0.747661091773226,-0.747661091773226,-0.747661091773226,-0.747661091773226,-0.747661091773226,-0.747661091773226,-0.747661091773226,-0.747661091773226,-0.747661091773226,-0.747661091773226,-0.747661091773226,0.694256728075138,0.801065455471313,0.587448000678963,0.801065455471313,0.480639273282788,0.801065455471313,0.373830545886613,0.801065455471313,0.267021818490438,0.801065455471313,0.160213091094263,0.801065455471313,0.0534043636980876,0.801065455471313,-0.0534043636980875,0.801065455471313,-0.160213091094263,0.801065455471313,-0.267021818490438,0.801065455471313,-0.373830545886613,0.801065455471313,-0.480639273282788,0.801065455471313,-0.587448000678963,-0.694256728075138,0.694256728075138,0.587448000678963,0.480639273282788,0.373830545886613,0.267021818490438,0.160213091094263,0.0534043636980876,-0.0534043636980875,-0.160213091094263,-0.267021818490438,-0.373830545886613,-0.480639273282788,-0.587448000678963,-0.694256728075138,-0.801065455471313,-0.801065455471313,-0.801065455471313,-0.801065455471313,-0.801065455471313,-0.801065455471313,-0.801065455471313,-0.801065455471313,-0.801065455471313,-0.801065455471313,-0.801065455471313,-0.801065455471313,0.640852364377051,0.534043636980876,0.854469819169401,0.427234909584700,0.854469819169401,0.320426182188525,0.854469819169401,0.213617454792350,0.854469819169401,0.106808727396175,0.854469819169401,4.16333634234434e-17,0.854469819169401,-0.106808727396175,0.854469819169401,-0.213617454792350,0.854469819169401,-0.320426182188525,0.854469819169401,-0.427234909584700,-0.534043636980875,-0.640852364377051,0.640852364377051,0.534043636980876,0.427234909584700,0.320426182188525,0.213617454792350,0.106808727396175,4.16333634234434e-17,-0.106808727396175,-0.213617454792350,-0.320426182188525,-0.427234909584700,-0.534043636980875,-0.640852364377051,-0.854469819169401,-0.854469819169401,-0.854469819169401,-0.854469819169401,-0.854469819169401,-0.854469819169401,-0.854469819169401,-0.854469819169401,-0.854469819169401,0.587448000678963,0.480639273282788,0.373830545886613,0.267021818490438,0.907874182867488,0.160213091094263,0.907874182867488,0.0534043636980876,0.907874182867488,-0.0534043636980875,0.907874182867488,-0.160213091094263,-0.267021818490438,-0.373830545886613,-0.480639273282788,-0.587448000678963,0.587448000678963,0.480639273282788,0.373830545886613,0.267021818490438,0.160213091094263,0.0534043636980876,-0.0534043636980875,-0.160213091094263,-0.267021818490438,-0.373830545886613,-0.480639273282788,-0.587448000678963,-0.907874182867488,-0.907874182867488,-0.907874182867488,-0.907874182867488,0.534043636980876,0.427234909584700,0.320426182188525,0.213617454792350,0.106808727396175,4.16333634234434e-17,-0.106808727396175,-0.213617454792350,-0.320426182188525,-0.427234909584700,-0.534043636980875,0.534043636980876,0.427234909584700,0.320426182188525,0.213617454792350,0.106808727396175,4.16333634234434e-17,-0.106808727396175,-0.213617454792350,-0.320426182188525,-0.427234909584700,-0.534043636980875,0.480639273282788,0.373830545886613,0.267021818490438,0.160213091094263,0.0534043636980877,-0.0534043636980875,-0.160213091094263,-0.267021818490438,-0.373830545886613,-0.480639273282788,0.480639273282788,0.373830545886613,0.267021818490438,0.160213091094263,0.0534043636980877,-0.0534043636980875,-0.160213091094263,-0.267021818490438,-0.373830545886613,-0.480639273282788,0.427234909584700,0.320426182188525,0.213617454792350,0.106808727396175,9.71445146547012e-17,-0.106808727396175,-0.213617454792350,-0.320426182188525,-0.427234909584700,0.427234909584700,0.320426182188525,0.213617454792350,0.106808727396175,9.71445146547012e-17,-0.106808727396175,-0.213617454792350,-0.320426182188525,-0.427234909584700,0.373830545886613,0.267021818490438,0.160213091094263,0.0534043636980877,-0.0534043636980875,-0.160213091094263,-0.267021818490438,-0.373830545886613,0.373830545886613,0.267021818490438,0.160213091094263,0.0534043636980877,-0.0534043636980875,-0.160213091094263,-0.267021818490438,-0.373830545886613,0.320426182188525,0.213617454792350,0.106808727396175,9.71445146547012e-17,-0.106808727396175,-0.213617454792350,-0.320426182188525,0.320426182188525,0.213617454792350,0.106808727396175,9.71445146547012e-17,-0.106808727396175,-0.213617454792350,-0.320426182188525,0.267021818490438,0.160213091094263,0.0534043636980877,-0.0534043636980875,-0.160213091094263,-0.267021818490438,0.267021818490438,0.160213091094263,0.0534043636980877,-0.0534043636980875,-0.160213091094263,-0.267021818490438,0.106808727396175,9.71445146547012e-17,-0.106808727396175,0.106808727396175,9.71445146547012e-17,-0.106808727396175,3.16634267457473,3.16634267457473,3.05953394717856,3.05953394717856,3.21974703827282,3.21974703827282,3.11293831087664,3.11293831087664,3.21974703827282,3.11293831087664,3.00612958348047,3.00612958348047,3.00612958348047,3.27315140197091,3.27315140197091,3.16634267457473,3.27315140197091,3.05953394717856,3.27315140197091,3.16634267457473,3.05953394717856,2.95272521978238,2.95272521978238,2.95272521978238,2.95272521978238,3.32655576566900,3.32655576566900,3.21974703827282,3.32655576566900,3.11293831087664,3.32655576566900,3.00612958348047,3.32655576566900,3.21974703827282,3.11293831087664,3.00612958348047,2.89932085608429,2.89932085608429,2.89932085608429,2.89932085608429,2.89932085608429,3.37996012936708,3.37996012936708,3.27315140197091,3.37996012936708,3.16634267457473,3.37996012936708,3.05953394717856,3.37996012936708,2.95272521978238,3.37996012936708,3.27315140197091,3.16634267457473,3.05953394717856,2.95272521978238,2.84591649238621,2.84591649238621,2.84591649238621,2.84591649238621,2.84591649238621,2.84591649238621,3.43336449306517,3.43336449306517,3.32655576566900,3.43336449306517,3.21974703827282,3.43336449306517,3.11293831087664,3.43336449306517,3.00612958348047,3.43336449306517,2.89932085608429,3.43336449306517,3.32655576566900,3.21974703827282,3.11293831087664,3.00612958348047,2.89932085608429,2.79251212868812,2.79251212868812,2.79251212868812,2.79251212868812,2.79251212868812,2.79251212868812,2.79251212868812,3.48676885676326,3.48676885676326,3.37996012936708,3.48676885676326,3.27315140197091,3.48676885676326,3.16634267457473,3.48676885676326,3.05953394717856,3.48676885676326,2.95272521978238,3.48676885676326,2.84591649238621,3.48676885676326,3.37996012936708,3.27315140197091,3.16634267457473,3.05953394717856,2.95272521978238,2.84591649238621,2.73910776499003,2.73910776499003,2.73910776499003,2.73910776499003,2.73910776499003,2.73910776499003,2.73910776499003,2.73910776499003,3.54017322046135,3.54017322046135,3.43336449306517,3.54017322046135,3.32655576566900,3.54017322046135,3.21974703827282,3.54017322046135,3.11293831087664,3.54017322046135,3.00612958348047,3.54017322046135,2.89932085608429,3.54017322046135,2.79251212868812,3.54017322046135,3.43336449306517,3.32655576566900,3.21974703827282,3.11293831087664,3.00612958348047,2.89932085608429,2.79251212868812,2.68570340129194,2.68570340129194,2.68570340129194,2.68570340129194,2.68570340129194,2.68570340129194,2.68570340129194,2.68570340129194,2.68570340129194,3.59357758415943,3.59357758415943,3.48676885676326,3.59357758415943,3.37996012936708,3.59357758415943,3.27315140197091,3.59357758415943,3.16634267457473,3.59357758415943,3.05953394717856,3.59357758415943,2.95272521978238,3.59357758415943,2.84591649238621,3.59357758415943,2.73910776499003,3.59357758415943,3.48676885676326,3.37996012936708,3.27315140197091,3.16634267457473,3.05953394717856,2.95272521978238,2.84591649238621,2.73910776499003,2.63229903759386,2.63229903759386,2.63229903759386,2.63229903759386,2.63229903759386,2.63229903759386,2.63229903759386,2.63229903759386,2.63229903759386,2.63229903759386,3.64698194785752,3.64698194785752,3.54017322046135,3.64698194785752,3.43336449306517,3.64698194785752,3.32655576566900,3.64698194785752,3.21974703827282,3.64698194785752,3.11293831087664,3.64698194785752,3.00612958348047,3.64698194785752,2.89932085608429,3.64698194785752,2.79251212868812,3.64698194785752,2.68570340129194,3.64698194785752,3.54017322046135,3.43336449306517,3.32655576566900,3.21974703827282,3.11293831087664,3.00612958348047,2.89932085608429,2.79251212868812,2.68570340129194,2.57889467389577,2.57889467389577,2.57889467389577,2.57889467389577,2.57889467389577,2.57889467389577,2.57889467389577,2.57889467389577,2.57889467389577,2.57889467389577,2.57889467389577,3.70038631155561,3.70038631155561,3.59357758415943,3.70038631155561,3.48676885676326,3.70038631155561,3.37996012936708,3.70038631155561,3.27315140197091,3.70038631155561,3.16634267457473,3.70038631155561,3.05953394717856,3.70038631155561,2.95272521978238,3.70038631155561,2.84591649238621,3.70038631155561,2.73910776499003,3.70038631155561,2.63229903759386,3.70038631155561,3.59357758415943,3.48676885676326,3.37996012936708,3.27315140197091,3.16634267457473,3.05953394717856,2.95272521978238,2.84591649238621,2.73910776499003,2.63229903759386,2.52549031019768,2.52549031019768,2.52549031019768,2.52549031019768,2.52549031019768,2.52549031019768,2.52549031019768,2.52549031019768,2.52549031019768,2.52549031019768,2.52549031019768,2.52549031019768,3.75379067525370,3.75379067525370,3.64698194785752,3.75379067525370,3.54017322046135,3.75379067525370,3.43336449306517,3.75379067525370,3.32655576566900,3.75379067525370,3.21974703827282,3.75379067525370,3.11293831087664,3.75379067525370,3.00612958348047,3.75379067525370,2.89932085608429,3.75379067525370,2.79251212868812,3.75379067525370,2.68570340129194,3.75379067525370,2.57889467389577,3.75379067525370,3.64698194785752,3.54017322046135,3.43336449306517,3.32655576566900,3.21974703827282,3.11293831087664,3.00612958348047,2.89932085608429,2.79251212868812,2.68570340129194,2.57889467389577,2.47208594649959,2.47208594649959,2.47208594649959,2.47208594649959,2.47208594649959,2.47208594649959,2.47208594649959,2.47208594649959,2.47208594649959,2.47208594649959,2.47208594649959,2.47208594649959,2.47208594649959,3.80719503895178,3.80719503895178,3.70038631155561,3.80719503895178,3.59357758415943,3.80719503895178,3.48676885676326,3.80719503895178,3.37996012936708,3.80719503895178,3.27315140197091,3.80719503895178,3.16634267457473,3.80719503895178,3.05953394717856,3.80719503895178,2.95272521978238,3.80719503895178,2.84591649238621,3.80719503895178,2.73910776499003,3.80719503895178,2.63229903759386,3.80719503895178,2.52549031019768,3.80719503895178,3.70038631155561,3.59357758415943,3.48676885676326,3.37996012936708,3.27315140197091,3.16634267457473,3.05953394717856,2.95272521978238,2.84591649238621,2.73910776499003,2.63229903759386,2.52549031019768,2.41868158280151,2.41868158280151,2.41868158280151,2.41868158280151,2.41868158280151,2.41868158280151,2.41868158280151,2.41868158280151,2.41868158280151,2.41868158280151,2.41868158280151,2.41868158280151,2.41868158280151,2.41868158280151,3.75379067525370,3.86059940264987,3.64698194785752,3.86059940264987,3.54017322046135,3.86059940264987,3.43336449306517,3.86059940264987,3.32655576566900,3.86059940264987,3.21974703827282,3.86059940264987,3.11293831087664,3.86059940264987,3.00612958348047,3.86059940264987,2.89932085608429,3.86059940264987,2.79251212868812,3.86059940264987,2.68570340129194,3.86059940264987,2.57889467389577,3.86059940264987,2.47208594649959,3.75379067525370,3.64698194785752,3.54017322046135,3.43336449306517,3.32655576566900,3.21974703827282,3.11293831087664,3.00612958348047,2.89932085608429,2.79251212868812,2.68570340129194,2.57889467389577,2.47208594649959,2.36527721910342,2.36527721910342,2.36527721910342,2.36527721910342,2.36527721910342,2.36527721910342,2.36527721910342,2.36527721910342,2.36527721910342,2.36527721910342,2.36527721910342,2.36527721910342,2.36527721910342,2.36527721910342,2.36527721910342,3.70038631155561,3.59357758415943,3.91400376634796,3.48676885676326,3.91400376634796,3.37996012936708,3.91400376634796,3.27315140197091,3.91400376634796,3.16634267457473,3.91400376634796,3.05953394717856,3.91400376634796,2.95272521978238,3.91400376634796,2.84591649238621,3.91400376634796,2.73910776499003,3.91400376634796,2.63229903759386,2.52549031019768,2.41868158280151,3.80719503895178,3.70038631155561,3.59357758415943,3.48676885676326,3.37996012936708,3.27315140197091,3.16634267457473,3.05953394717856,2.95272521978238,2.84591649238621,2.73910776499003,2.63229903759386,2.52549031019768,2.41868158280151,2.31187285540533,2.31187285540533,2.31187285540533,2.31187285540533,2.31187285540533,2.31187285540533,2.31187285540533,2.31187285540533,2.31187285540533,2.31187285540533,2.31187285540533,2.31187285540533,2.31187285540533,2.31187285540533,2.31187285540533,3.64698194785752,3.54017322046135,3.43336449306517,3.32655576566900,3.96740813004605,3.21974703827282,3.96740813004605,3.11293831087664,3.96740813004605,3.00612958348047,3.96740813004605,2.89932085608429,2.79251212868812,2.68570340129194,2.57889467389577,2.47208594649959,3.75379067525370,3.64698194785752,3.54017322046135,3.43336449306517,3.32655576566900,3.21974703827282,3.11293831087664,3.00612958348047,2.89932085608429,2.79251212868812,2.68570340129194,2.57889467389577,2.47208594649959,2.36527721910342,2.25846849170724,2.25846849170724,2.25846849170724,2.25846849170724,2.25846849170724,2.25846849170724,2.25846849170724,2.25846849170724,2.25846849170724,2.25846849170724,2.25846849170724,2.25846849170724,3.59357758415943,3.48676885676326,3.37996012936708,3.27315140197091,3.16634267457473,3.05953394717856,2.95272521978238,2.84591649238621,2.73910776499003,2.63229903759386,2.52549031019768,3.70038631155561,3.59357758415943,3.48676885676326,3.37996012936708,3.27315140197091,3.16634267457473,3.05953394717856,2.95272521978238,2.84591649238621,2.73910776499003,2.63229903759386,2.52549031019768,2.41868158280151,2.20506412800915,2.20506412800915,2.20506412800915,2.20506412800915,2.20506412800915,2.20506412800915,2.20506412800915,2.20506412800915,2.20506412800915,3.54017322046135,3.43336449306517,3.32655576566900,3.21974703827282,3.11293831087664,3.00612958348047,2.89932085608429,2.79251212868812,2.68570340129194,2.57889467389577,3.64698194785752,3.54017322046135,3.43336449306517,3.32655576566900,3.21974703827282,3.11293831087664,3.00612958348047,2.89932085608429,2.79251212868812,2.68570340129194,2.57889467389577,2.47208594649959,2.15165976431107,2.15165976431107,2.15165976431107,2.15165976431107,3.48676885676326,3.37996012936708,3.27315140197091,3.16634267457473,3.05953394717856,2.95272521978238,2.84591649238621,2.73910776499003,2.63229903759386,3.59357758415943,3.48676885676326,3.37996012936708,3.27315140197091,3.16634267457473,3.05953394717856,2.95272521978238,2.84591649238621,2.73910776499003,2.63229903759386,2.52549031019768,3.43336449306517,3.32655576566900,3.21974703827282,3.11293831087664,3.00612958348047,2.89932085608429,2.79251212868812,2.68570340129194,3.54017322046135,3.43336449306517,3.32655576566900,3.21974703827282,3.11293831087664,3.00612958348047,2.89932085608429,2.79251212868812,2.68570340129194,2.57889467389577,3.37996012936708,3.27315140197091,3.16634267457473,3.05953394717856,2.95272521978238,2.84591649238621,2.73910776499003,3.48676885676326,3.37996012936708,3.27315140197091,3.16634267457473,3.05953394717856,2.95272521978238,2.84591649238621,2.73910776499003,2.63229903759386,3.32655576566900,3.21974703827282,3.11293831087664,3.00612958348047,2.89932085608429,2.79251212868812,3.43336449306517,3.32655576566900,3.21974703827282,3.11293831087664,3.00612958348047,2.89932085608429,2.79251212868812,2.68570340129194,3.16634267457473,3.05953394717856,2.95272521978238,3.37996012936708,3.27315140197091,3.16634267457473,3.05953394717856,2.95272521978238,2.84591649238621,2.73910776499003,3.32655576566900,3.21974703827282,3.11293831087664,3.00612958348047,2.89932085608429,2.79251212868812,3.16634267457473,3.05953394717856,2.95272521978238];
gvec_list_l_master = [0,-2.88455626842720,0,2.88455626842720,0,-2.88455626842720,0,2.88455626842720,0,-2.88455626842720,2.88455626842720,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,17.3073376105632,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,17.3073376105632,-20.1918938789904,20.1918938789904,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,17.3073376105632,-20.1918938789904,20.1918938789904,-23.0764501474176,23.0764501474176,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,17.3073376105632,-20.1918938789904,20.1918938789904,-23.0764501474176,23.0764501474176,-25.9610064158448,25.9610064158448,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,17.3073376105632,-20.1918938789904,20.1918938789904,-23.0764501474176,23.0764501474176,-25.9610064158448,25.9610064158448,-28.8455626842720,28.8455626842720,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,17.3073376105632,-20.1918938789904,20.1918938789904,-23.0764501474176,23.0764501474176,-25.9610064158448,25.9610064158448,-28.8455626842720,28.8455626842720,-31.7301189526992,31.7301189526992,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,17.3073376105632,-20.1918938789904,20.1918938789904,-23.0764501474176,23.0764501474176,-25.9610064158448,25.9610064158448,-28.8455626842720,28.8455626842720,-31.7301189526992,31.7301189526992,-34.6146752211264,34.6146752211264,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,17.3073376105632,-20.1918938789904,20.1918938789904,-23.0764501474176,23.0764501474176,-25.9610064158448,25.9610064158448,-28.8455626842720,28.8455626842720,-31.7301189526992,31.7301189526992,-34.6146752211264,34.6146752211264,-37.4992314895536,37.4992314895536,-40.3837877579809,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,40.3837877579809,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,17.3073376105632,-20.1918938789904,20.1918938789904,-23.0764501474176,23.0764501474176,-25.9610064158448,25.9610064158448,-28.8455626842720,28.8455626842720,-31.7301189526992,31.7301189526992,-34.6146752211264,34.6146752211264,-37.4992314895536,37.4992314895536,40.3837877579809,-40.3837877579809,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,5.76911253685441,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,17.3073376105632,-20.1918938789904,20.1918938789904,-23.0764501474176,23.0764501474176,-25.9610064158448,25.9610064158448,-28.8455626842720,28.8455626842720,-31.7301189526992,31.7301189526992,-34.6146752211264,34.6146752211264,37.4992314895536,40.3837877579809,-40.3837877579809,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,-20.1918938789904,20.1918938789904,-23.0764501474176,23.0764501474176,-25.9610064158448,25.9610064158448,-28.8455626842720,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,40.3837877579809,-40.3837877579809,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,40.3837877579809,-40.3837877579809,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,40.3837877579809,-40.3837877579809,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,40.3837877579809,-40.3837877579809,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,40.3837877579809,-40.3837877579809,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,40.3837877579809,-40.3837877579809,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,40.3837877579809,-40.3837877579809,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,31.7301189526992,34.6146752211264,37.4992314895536,-37.4992314895536,-34.6146752211264,-31.7301189526992,0,-2.88455626842720,0,2.88455626842720,0,-2.88455626842720,0,2.88455626842720,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,17.3073376105632,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,17.3073376105632,-20.1918938789904,20.1918938789904,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,17.3073376105632,-20.1918938789904,20.1918938789904,-23.0764501474176,23.0764501474176,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,17.3073376105632,-20.1918938789904,20.1918938789904,-23.0764501474176,23.0764501474176,-25.9610064158448,25.9610064158448,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,17.3073376105632,-20.1918938789904,20.1918938789904,-23.0764501474176,23.0764501474176,-25.9610064158448,25.9610064158448,-28.8455626842720,28.8455626842720,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,17.3073376105632,-20.1918938789904,20.1918938789904,-23.0764501474176,23.0764501474176,-25.9610064158448,25.9610064158448,-28.8455626842720,28.8455626842720,-31.7301189526992,31.7301189526992,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,0,-2.88455626842720,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,17.3073376105632,-20.1918938789904,20.1918938789904,-23.0764501474176,23.0764501474176,-25.9610064158448,25.9610064158448,-28.8455626842720,28.8455626842720,-31.7301189526992,31.7301189526992,-34.6146752211264,34.6146752211264,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,2.88455626842720,-5.76911253685441,5.76911253685441,-8.65366880528161,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,17.3073376105632,-20.1918938789904,20.1918938789904,-23.0764501474176,23.0764501474176,-25.9610064158448,25.9610064158448,-28.8455626842720,28.8455626842720,-31.7301189526992,31.7301189526992,-34.6146752211264,34.6146752211264,-37.4992314895536,37.4992314895536,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,40.3837877579809,5.76911253685441,8.65366880528161,-11.5382250737088,11.5382250737088,-14.4227813421360,14.4227813421360,-17.3073376105632,17.3073376105632,-20.1918938789904,20.1918938789904,-23.0764501474176,23.0764501474176,-25.9610064158448,25.9610064158448,-28.8455626842720,28.8455626842720,-31.7301189526992,31.7301189526992,-34.6146752211264,34.6146752211264,37.4992314895536,40.3837877579809,-40.3837877579809,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,0,2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,40.3837877579809,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,-20.1918938789904,20.1918938789904,-23.0764501474176,23.0764501474176,-25.9610064158448,25.9610064158448,-28.8455626842720,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,40.3837877579809,-40.3837877579809,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,-2.88455626842720,5.76911253685441,8.65366880528161,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,40.3837877579809,-40.3837877579809,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,-5.76911253685441,11.5382250737088,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,14.4227813421360,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,40.3837877579809,-40.3837877579809,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,-8.65366880528161,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,17.3073376105632,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,40.3837877579809,-40.3837877579809,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,-11.5382250737088,20.1918938789904,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,40.3837877579809,-40.3837877579809,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,-14.4227813421360,23.0764501474176,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,40.3837877579809,-40.3837877579809,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,-17.3073376105632,25.9610064158448,28.8455626842720,31.7301189526992,34.6146752211264,37.4992314895536,40.3837877579809,-40.3837877579809,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-20.1918938789904,31.7301189526992,34.6146752211264,37.4992314895536,-40.3837877579809,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-23.0764501474176,-40.3837877579809,-37.4992314895536,-34.6146752211264,-31.7301189526992,-28.8455626842720,-25.9610064158448,-37.4992314895536,-34.6146752211264,-31.7301189526992];

hvec_list = cell(1,length(hvec_list_h_master));
gvec_list = cell(1,length(hvec_list_h_master));

for i = 1:length(hvec_list_h_master)
    
    hvec_list{i} = [hvec_list_h_master(i) hvec_list_k_master(i) hvec_list_l_master(i)];
    gvec_list{i} = [gvec_list_h_master(i) gvec_list_k_master(i) gvec_list_l_master(i)];
    
end

% setting up the Bragg spots
simspots = length(hvec_list_h_master);
spot_angles = zeros(1,simspots);
ext_dist_arr = zeros(1,simspots);
SF_arr = zeros(1,simspots);
Vg_mag_list = zeros(1,simspots);

% Function to calculate the excitation error
s_g = @(g)  (k_mag^2 - dot(k_actual' + g,k_actual'+g))/(2*sqrt(dot(k_actual'+g,k_actual'+g)));

% Bragg angles
angles = @(x,y,z) asind(lambda/2*sqrt(x.*x+y.*y+z.*z)*1e9);

% Determine which surface is the first surface of contact based on electron path travel
if k_unit(2) > 0
    start_y = @(x) y_bot(x);
    end_y = @(x) y_top(x);
    top_bot = 1;
elseif k_unit(2) < 0
    start_y = @(x) y_top(x);
    end_y = @(x) y_bot(x);
    top_bot = 0;
else
    throw('Stop using weird geometries. This will not propagate through the specimen.');
end

% Calculating slopes of the surfaces and associated inverse slopes
top_slope = slope;
bot_slope = -slope;
top_inv_slope = -1/top_slope;
bot_inv_slope = -1/bot_slope;
top_inv_vec = [1, top_inv_slope, 0];
top_inv_vec = top_inv_vec/sqrt(dot(top_inv_vec,top_inv_vec));
bot_inv_vec = [1, bot_inv_slope, 0];
bot_inv_vec = bot_inv_vec/sqrt(dot(bot_inv_vec,bot_inv_vec));

% Setting up intensities of each Bragg spot
summed_intensities = zeros(1,simspots+1);
summed_intensities(1) = 1;

% Setting up contrast
bf_contrast = zeros(length(xvals),length(timevals));

thicknesses = zeros(length(xvals),length(timevals));

% Setting up the travel distance of each increment
k_slope = k_unit(2)/k_unit(1);
x_incr = sign(k_unit(1))*xy_dist_incr/sqrt(1+k_slope^2);
y_incr = sign(k_unit(2))*xy_dist_incr/sqrt(1+(1/k_slope)^2);
dist_travel = sqrt(abs(x_incr)^2 + abs(y_incr)^2 + abs(k_unit(3)/k_unit(2)*y_incr)^2);

tic;
for k = 1:length(timevals)
    parfor i = 1:length(xvals)
        
        summed_intensities = zeros(1,simspots+1);
        summed_intensities(1) = 1;
        
        curx = xvals(i);
        cur_start_y = start_y(curx);
        cury = cur_start_y;
        
        tot_thick = 0;
        num_incr = 0;
        strain_vec = [];
        vel_vec = [];
        
        prevx_lamb = curx + combined_x(curx, cury, timevals(k));
        prevy_lamb = cury + combined_y(curx, cury, timevals(k));
        while abs(cury) <= abs(end_y(curx))
            
            s_g_vec = zeros(simspots+1,3);
            s_g_mag = zeros(simspots+1,1);
            mod_gvec_list = zeros(simspots+1,3);
            mod_hvec_list = zeros(simspots+1,3);
            g_angles = zeros(simspots+1,simspots+1);
            gx_dif_matr = zeros(simspots+1,simspots+1);
            gy_dif_matr = zeros(simspots+1,simspots+1);
            gz_dif_matr = zeros(simspots+1,simspots+1);
            hx_dif_matr = zeros(simspots+1,simspots+1);
            hy_dif_matr = zeros(simspots+1,simspots+1);
            hz_dif_matr = zeros(simspots+1,simspots+1);
            pot_phase = zeros(simspots+1, simspots+1);
            pot_mag = zeros(simspots+1, simspots+1);
            pot_mag_imag = zeros(simspots+1, simspots+1);
            pot_abs = zeros(simspots+1, simspots+1);
            pot_phase_fact_r = zeros(simspots+1, simspots+1);
            pot_phase_fact_i = zeros(simspots+1, simspots+1);
            U_matr = zeros(simspots+1, simspots+1);
            
            curx_lamb = curx + combined_x(curx, cury, timevals(k));
            cury_lamb = cury + combined_y(curx, cury, timevals(k));
            
            %% CURRENT ISSUE: NEED TO FIND s_g
            
            %% CALCULATE THE STRAIN IN THIS REGION VIA 6 POINTS
            % SEPARATION DISTANCE WILL BE ARBITRARY (NN BOND DISTANCE)
            
            x1 = curx - strainpar/2;
            x2 = curx + strainpar/2;
            y1 = cury - strainpar/2;
            y2 = cury + strainpar/2;
            
            uxxn1n = double(combined_x(x1, cury, timevals(k)));
            uxxn2n = double(combined_x(x2, cury, timevals(k)));
            uxyn1n = double(combined_x(curx, y1, timevals(k)));
            uxyn2n = double(combined_x(curx, y2, timevals(k)));
            
            uyyny1 = double(combined_y(curx, y1, timevals(k)));
            uyyny2 = double(combined_y(curx, y2, timevals(k)));
            uyxn1n = double(combined_y(x1, cury, timevals(k)));
            uyxn2n = double(combined_y(x2, cury, timevals(k)));
            
            strain_xx = (uxxn2n-uxxn1n)/(x2-x1);
            strain_yy = (uyyny2-uyyny1)/(y2-y1);
            strain_xyyz = ((uyxn2n - uyxn1n)/(x2-x1) + (uxyn2n - uxyn1n)/(y2-y1))/2;
            
            trans_matr = [1+strain_xx,strain_xyyz,0;strain_xyyz,1+strain_yy,0;0 0 1];
            trans_matr_act = or_z_rot*or_x_rot*[1+strain_xx,strain_xyyz,0;strain_xyyz,1+strain_yy,0;0 0 1];
            vol_strain = trans_matr(1,1)*trans_matr(2,2)-trans_matr(1,2)^2;
            recip_trans_matr = [trans_matr(2,2), -1*trans_matr(1,2), 0; -1*trans_matr(1,2), trans_matr(1,1), 0; 0, 0, 1]./vol_strain;
            recip_trans_matr_act = or_z_rot*or_x_rot*[trans_matr(2,2), -1*trans_matr(1,2), 0; -1*trans_matr(1,2), trans_matr(1,1), 0; 0, 0, 1]./vol_strain;
            
            strain_vec = [strain_vec; strain_xx, strain_yy, strain_xyyz];
            
            %% CALCULATE THE VELOCITY IN THE REGION VIA SMALL TIME ADJUSTMENTS
            % SEPARATION TIME WILL BE 1/10th OF THE TIME SEPARATION IN
            % TIMEVALS
            
            posx1_lamb = curx + combined_x(curx, cury, timevals(k) - timesep/10);
            posx2_lamb = curx + combined_x(curx, cury, timevals(k) + timesep/10);
            
            posy1_lamb = cury + combined_y(curx, cury, timevals(k) - timesep/10);
            posy2_lamb = cury + combined_y(curx, cury, timevals(k) + timesep/10);
            
            vel_vec = [vel_vec; (posx2_lamb - posx1_lamb)/timetest/2, (posy2_lamb - posy1_lamb)/timetest/2];
            
            %% THEN NEED TO FIND s_g via change in g
            
            r1n = trans_matr_act*r1';
            r2n = trans_matr_act*r2';
            r3n = trans_matr_act*r3';
            r4n = trans_matr_act*r4';
            r5n = trans_matr_act*r5';
            r6n = trans_matr_act*r6';
            r7n = trans_matr_act*r7';
            r8n = trans_matr_act*r8';
            
            for hvec_count = 1:simspots
                
                curg_vec = gvec_list{hvec_count};
                curh_vec = hvec_list{hvec_count};

                mod_gvec_list(hvec_count+1,:) = recip_trans_matr*curg_vec';
                
                mod_hvec_list(hvec_count+1,:) = recip_trans_matr_act*curh_vec';
                
                curg_vec_str = mod_gvec_list(hvec_count+1,:);
                
                dir_vec = (k_actual' + curg_vec_str)/sqrt(dot(k_actual'+curg_vec_str,k_actual'+curg_vec_str));
                
                s_g_vec(hvec_count+1,:) = dir_vec*s_g(curg_vec_str);
                
                s_g_mag(hvec_count+1,:) = s_g(curg_vec_str)*1e9;
            
            end

            D = bsxfun(@minus, mod_gvec_list(:,1), mod_gvec_list(:,1)');                                  % Subtract To Create Matrix
            gx_dif_matr = D;
            
            D = bsxfun(@minus, mod_gvec_list(:,2), mod_gvec_list(:,2)');                                  % Subtract To Create Matrix
            gy_dif_matr = D;
            
            D = bsxfun(@minus, mod_gvec_list(:,3), mod_gvec_list(:,3)');                                  % Subtract To Create Matrix
            gz_dif_matr = D;
            
            D = bsxfun(@minus, mod_hvec_list(:,1), mod_hvec_list(:,1)');                                  % Subtract To Create Matrix
            hx_dif_matr = D;
            
            D = bsxfun(@minus, mod_hvec_list(:,2), mod_hvec_list(:,2)');                                  % Subtract To Create Matrix
            hy_dif_matr = D;
            
            D = bsxfun(@minus, mod_hvec_list(:,3), mod_hvec_list(:,3)');                                  % Subtract To Create Matrix
            hz_dif_matr = D;
            
            g_angles = angles(gx_dif_matr,gy_dif_matr,gz_dif_matr);
            
            pot_phase = Ge_SF(hx_dif_matr,hy_dif_matr,hz_dif_matr,r1n,r2n,r3n,r4n,r5n,r6n,r7n,r8n);
            
            pot_mag = Ge_RPOT(g_angles,gx_dif_matr,gy_dif_matr,gz_dif_matr);
            
            pot_mag_imag = Ge_IPOT(g_angles,gx_dif_matr,gy_dif_matr,gz_dif_matr);
            
            for strack = 1:simspots+1
                pot_mag(strack,strack) = 0;
                pot_mag_imag(strack,strack) = 0;
            end
            
            U_matr_imag = abs(pot_phase.*pot_mag_imag);
            U_matr_real = abs(pot_phase.*pot_mag);
            U_matr = exp(sqrt(-1)*pot_phase_fact_r).*U_matr_real;% + exp(sqrt(-1)*pot_phase_fact_i)*sqrt(-1).*U_matr_imag; don't want TDS yet
            
            if k_unit(1) ~= 0
                true_thick_incr = double(sqrt((curx_lamb - prevx_lamb)^2 + (cury_lamb - prevy_lamb)^2 + (k_unit(3)/k_unit(1)*(curx_lamb - prevx_lamb))^2));
            elseif k_unit(2) ~= 0
                true_thick_incr = double(sqrt((curx_lamb - prevx_lamb)^2 + (cury_lamb - prevy_lamb)^2 + (k_unit(3)/k_unit(2)*(cury_lamb - prevy_lamb))^2));
            else
                true_thick_incr = thick_incr;
            end
            
            exc_err_matr = 2*pi*diag(s_g_mag);
            interact_matr = pi*U_matr;
            
            DHW_matr = exc_err_matr + interact_matr;
            
            exp_matr = sqrt(-1)*(DHW_matr)*true_thick_incr*1e-9;

            summed_intensities = expm(exp_matr)*summed_intensities';
            summed_intensities = summed_intensities';
            
            summed_intensities = summed_intensities./sqrt(sum(abs(summed_intensities).^2));
            curx = curx + x_incr;
            cury = cury + y_incr;
            
            tot_thick = true_thick_incr+tot_thick;
            
            prevx_lamb = curx_lamb;
            prevy_lamb = cury_lamb;
            
        end
        
        strain_matr{i,k} = strain_vec;
        vel_matr{i,k} = vel_vec;
        
        absorb = Ge_SF(0,0,0,r1,r2,r3,r4,r5,r6,r7,r8)*47.87801/(V_c*10^3)*(Ge_AFF(0))*2*rel_mass*e_charge/(planck)^2./(sqrt(dot(k_actual',k_actual'))*1e9);
        summed_intensities = summed_intensities*exp(-2*pi*(tot_thick*1e-9)*absorb);
        
        bf_contrast(i,k) = abs(summed_intensities(1));
        thicknesses(i,k) = tot_thick;
    end
    k
end
toc